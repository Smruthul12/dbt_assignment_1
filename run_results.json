{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-21T08:00:43.935800Z", "invocation_id": "ce858b50-1352-4827-9d72-3526da376932", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.393418Z", "completed_at": "2025-02-21T08:00:42.404361Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.404996Z", "completed_at": "2025-02-21T08:00:42.405011Z"}], "thread_id": "Thread-1", "execution_time": 0.012885808944702148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.raw_retail", "compiled": true, "compiled_code": "\n\nWITH raw_retail AS (\n    SELECT\n        *\n    FROM\n        Retail_Analytics_dbt.ecommerce.raw_retail_data\n)\nSELECT\n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice AS UnitPrice_str,\n    CustomerID,\n    Country\nFROM\n    raw_retail", "relation_name": "Retail_Analytics_dbt.DEV.raw_retail", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.407993Z", "completed_at": "2025-02-21T08:00:42.416157Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.416778Z", "completed_at": "2025-02-21T08:00:42.416786Z"}], "thread_id": "Thread-1", "execution_time": 0.01015782356262207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.retail_cleansed", "compiled": true, "compiled_code": "\n\nWITH filtered_data AS (\n    SELECT\n        InvoiceNo,\n        StockCode,\n        TRIM(UPPER(Description)) AS Description,\n        Quantity,\n        CAST(InvoiceDate AS DATE) AS InvoiceDate,  \n        CASE \n            WHEN UnitPrice_str REGEXP '^[0-9]+(\\.[0-9]+)?$' \n                 AND CAST(UnitPrice_str AS FLOAT) > 0 \n            THEN CAST(UnitPrice_str AS FLOAT)\n            ELSE NULL  \n        END AS UnitPrice,\n        CustomerID,\n        TRIM(UPPER(Country)) AS Country,\n        ROW_NUMBER() OVER (PARTITION BY InvoiceNo ORDER BY InvoiceDate DESC) AS row_num\n    FROM Retail_Analytics_dbt.DEV.raw_retail\n    WHERE \n        InvoiceNo IS NOT NULL \n        AND CustomerID IS NOT NULL \n        AND Description IS NOT NULL \n        AND Description REGEXP '^[A-Za-z0-9 ]+$'\n        AND Quantity > 0\n\n        \n        AND InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.retail_cleansed)  \n        \n)\n\nSELECT \n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice,\n    CustomerID,\n    Country\nFROM filtered_data\nWHERE row_num = 1 \nAND UnitPrice IS NOT NULL", "relation_name": "Retail_Analytics_dbt.DEV.retail_cleansed", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.420843Z", "completed_at": "2025-02-21T08:00:42.426801Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.427669Z", "completed_at": "2025-02-21T08:00:42.427680Z"}], "thread_id": "Thread-1", "execution_time": 0.008636474609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_rfm", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency,\n        frequency,\n        monetary_value,\n        NTILE(5) OVER (ORDER BY recency DESC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency ASC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value ASC) AS monetary_score\n    FROM rfm_base\n)\n\nSELECT \n    CustomerID,\n    recency,\n    frequency,\n    monetary_value,\n    recency_score,\n    frequency_score,\n    monetary_score,\n    recency_score + frequency_score + monetary_score AS rfm_total_score\nFROM rfm_scores", "relation_name": "Retail_Analytics_dbt.DEV.customer_rfm", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.440790Z", "completed_at": "2025-02-21T08:00:42.445841Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.446701Z", "completed_at": "2025-02-21T08:00:42.446711Z"}], "thread_id": "Thread-1", "execution_time": 0.0072612762451171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.facts_sales", "compiled": true, "compiled_code": "\n\nWITH new_sales AS (\n    SELECT \n        InvoiceNo,\n        InvoiceDate,\n        CustomerID,\n        StockCode,\n        Quantity,\n        UnitPrice,\n        Quantity * UnitPrice AS total_amount\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    \n    \n    WHERE InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.facts_sales)\n    \n)\n\nSELECT * FROM new_sales", "relation_name": "Retail_Analytics_dbt.DEV.facts_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.450229Z", "completed_at": "2025-02-21T08:00:42.455203Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.455787Z", "completed_at": "2025-02-21T08:00:42.455795Z"}], "thread_id": "Thread-1", "execution_time": 0.0070459842681884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.rfm_segmentation", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    WHERE CustomerID IS NOT NULL\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency, \n        frequency,\n        monetary_value,\n\n        NTILE(5) OVER (ORDER BY recency ASC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency DESC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value DESC) AS monetary_score\n\n    FROM rfm_base\n),\n\nrfm_segmentation AS (\n    SELECT \n        CustomerID,\n        recency,\n        frequency,\n        monetary_value,\n        recency_score,\n        frequency_score,\n        monetary_score,\n        \n        recency_score + frequency_score + monetary_score AS rfm_total_score,\n\n        CASE \n            WHEN recency_score >= 4 AND frequency_score >= 4 AND monetary_score >= 4 THEN 'Best Customers'\n            WHEN recency_score >= 3 AND frequency_score >= 3 AND monetary_score >= 3 THEN 'Loyal Customers'\n            WHEN recency_score >= 3 AND frequency_score <= 2 THEN 'New Customers'\n            WHEN recency_score <= 2 AND frequency_score >= 4 THEN 'At Risk Customers'\n            WHEN recency_score <= 2 AND frequency_score <= 2 THEN 'Lost Customers'\n            ELSE 'Others'\n        END AS customer_segment\n    FROM rfm_scores\n)\n\nSELECT * FROM rfm_segmentation", "relation_name": "Retail_Analytics_dbt.DEV.rfm_segmentation", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.458566Z", "completed_at": "2025-02-21T08:00:42.462898Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.463459Z", "completed_at": "2025-02-21T08:00:42.463467Z"}], "thread_id": "Thread-1", "execution_time": 0.006255626678466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.sales_performance", "compiled": true, "compiled_code": "-- sales performance by month\n\n\nWITH sales AS (\n    SELECT\n        DATE_TRUNC('month', InvoiceDate) AS month,\n        SUM(Quantity * UnitPrice) AS total_sales,\n        COUNT(DISTINCT InvoiceNo) AS total_orders\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY 1\n)\n\nSELECT \n    month,\n    total_sales,\n    total_orders\nFROM sales\nORDER BY month DESC", "relation_name": "Retail_Analytics_dbt.DEV.sales_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.466389Z", "completed_at": "2025-02-21T08:00:42.471781Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.472341Z", "completed_at": "2025-02-21T08:00:42.472349Z"}], "thread_id": "Thread-1", "execution_time": 0.007228374481201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_country___A_Z_.a56523768c", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(country, '^[A-Z ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.475035Z", "completed_at": "2025-02-21T08:00:42.480281Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.480874Z", "completed_at": "2025-02-21T08:00:42.480882Z"}], "thread_id": "Thread-1", "execution_time": 0.007108211517333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_description___A_Za_z0_9_.c511af4a01", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(description, '^[A-Za-z0-9 ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.483590Z", "completed_at": "2025-02-21T08:00:42.494089Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.494673Z", "completed_at": "2025-02-21T08:00:42.494681Z"}], "thread_id": "Thread-1", "execution_time": 0.012430667877197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_country.6f766fcede", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.497389Z", "completed_at": "2025-02-21T08:00:42.502249Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.502833Z", "completed_at": "2025-02-21T08:00:42.502841Z"}], "thread_id": "Thread-1", "execution_time": 0.006796836853027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_customerid.ee2eb7401f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.505484Z", "completed_at": "2025-02-21T08:00:42.510329Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.510921Z", "completed_at": "2025-02-21T08:00:42.510929Z"}], "thread_id": "Thread-1", "execution_time": 0.006728649139404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_description.f7892dd595", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect description\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere description is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.513630Z", "completed_at": "2025-02-21T08:00:42.518454Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.519035Z", "completed_at": "2025-02-21T08:00:42.519043Z"}], "thread_id": "Thread-1", "execution_time": 0.006759166717529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoicedate.158713fed2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.521711Z", "completed_at": "2025-02-21T08:00:42.527495Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.528082Z", "completed_at": "2025-02-21T08:00:42.528089Z"}], "thread_id": "Thread-1", "execution_time": 0.007684230804443359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoiceno.4de3fe5244", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.530770Z", "completed_at": "2025-02-21T08:00:42.535612Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.536183Z", "completed_at": "2025-02-21T08:00:42.536191Z"}], "thread_id": "Thread-1", "execution_time": 0.006671905517578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_quantity.c66a8f7258", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.538866Z", "completed_at": "2025-02-21T08:00:42.543677Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.544240Z", "completed_at": "2025-02-21T08:00:42.544248Z"}], "thread_id": "Thread-1", "execution_time": 0.006613254547119141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_stockcode.a80aad6f0d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.547037Z", "completed_at": "2025-02-21T08:00:42.551953Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.552522Z", "completed_at": "2025-02-21T08:00:42.552550Z"}], "thread_id": "Thread-1", "execution_time": 0.006832122802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_unitprice.c8e43c7c7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.555248Z", "completed_at": "2025-02-21T08:00:42.560017Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.560610Z", "completed_at": "2025-02-21T08:00:42.560618Z"}], "thread_id": "Thread-1", "execution_time": 0.006681919097900391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_quantity.ebbe111451", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.563284Z", "completed_at": "2025-02-21T08:00:42.569060Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.569639Z", "completed_at": "2025-02-21T08:00:42.569646Z"}], "thread_id": "Thread-1", "execution_time": 0.007659435272216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_unitprice.702e3bce82", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.572269Z", "completed_at": "2025-02-21T08:00:42.579379Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.579966Z", "completed_at": "2025-02-21T08:00:42.579974Z"}], "thread_id": "Thread-1", "execution_time": 0.008933067321777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_retail_cleansed_invoiceno.752ff487db", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.582715Z", "completed_at": "2025-02-21T08:00:42.587968Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.588567Z", "completed_at": "2025-02-21T08:00:42.588575Z"}], "thread_id": "Thread-1", "execution_time": 0.007232666015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_frequency_score__5__1.2812983e24", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.591313Z", "completed_at": "2025-02-21T08:00:42.596567Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.597138Z", "completed_at": "2025-02-21T08:00:42.597146Z"}], "thread_id": "Thread-1", "execution_time": 0.007176876068115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_monetary_score__5__1.01604b14de", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.599853Z", "completed_at": "2025-02-21T08:00:42.606052Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.606641Z", "completed_at": "2025-02-21T08:00:42.606649Z"}], "thread_id": "Thread-1", "execution_time": 0.008116006851196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_recency_score__5__1.2025cc414f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.609354Z", "completed_at": "2025-02-21T08:00:42.614569Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.615144Z", "completed_at": "2025-02-21T08:00:42.615152Z"}], "thread_id": "Thread-1", "execution_time": 0.007131814956665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_rfm_total_score__15__3.0233537330", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.617875Z", "completed_at": "2025-02-21T08:00:42.622753Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.623321Z", "completed_at": "2025-02-21T08:00:42.623329Z"}], "thread_id": "Thread-1", "execution_time": 0.0067746639251708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_customerid.8756c1c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.626020Z", "completed_at": "2025-02-21T08:00:42.631089Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.631676Z", "completed_at": "2025-02-21T08:00:42.631684Z"}], "thread_id": "Thread-1", "execution_time": 0.006961822509765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency.4f6126998b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.634337Z", "completed_at": "2025-02-21T08:00:42.640090Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.640673Z", "completed_at": "2025-02-21T08:00:42.640681Z"}], "thread_id": "Thread-1", "execution_time": 0.0076448917388916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency_score.ac5407a1e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.643371Z", "completed_at": "2025-02-21T08:00:42.648143Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.648728Z", "completed_at": "2025-02-21T08:00:42.648736Z"}], "thread_id": "Thread-1", "execution_time": 0.006690502166748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_score.c8961d5f9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.651413Z", "completed_at": "2025-02-21T08:00:42.656221Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.656804Z", "completed_at": "2025-02-21T08:00:42.656812Z"}], "thread_id": "Thread-1", "execution_time": 0.0067138671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_value.1afb87803e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.659485Z", "completed_at": "2025-02-21T08:00:42.664475Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.665064Z", "completed_at": "2025-02-21T08:00:42.665071Z"}], "thread_id": "Thread-1", "execution_time": 0.006893157958984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency.ce57eb9baf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.667724Z", "completed_at": "2025-02-21T08:00:42.673484Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.674082Z", "completed_at": "2025-02-21T08:00:42.674089Z"}], "thread_id": "Thread-1", "execution_time": 0.0076770782470703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency_score.da6e261a1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.676798Z", "completed_at": "2025-02-21T08:00:42.681675Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.682244Z", "completed_at": "2025-02-21T08:00:42.682252Z"}], "thread_id": "Thread-1", "execution_time": 0.00676727294921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_rfm_total_score.a359721407", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.684973Z", "completed_at": "2025-02-21T08:00:42.689679Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.690254Z", "completed_at": "2025-02-21T08:00:42.690262Z"}], "thread_id": "Thread-1", "execution_time": 0.006613254547119141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_frequency.d2fca0de8b", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.693011Z", "completed_at": "2025-02-21T08:00:42.697779Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.698341Z", "completed_at": "2025-02-21T08:00:42.698348Z"}], "thread_id": "Thread-1", "execution_time": 0.006677150726318359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_monetary_value.2a5a7cba3d", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.701138Z", "completed_at": "2025-02-21T08:00:42.706698Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.707263Z", "completed_at": "2025-02-21T08:00:42.707271Z"}], "thread_id": "Thread-1", "execution_time": 0.007475137710571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_recency.3a739403c4", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.709978Z", "completed_at": "2025-02-21T08:00:42.714817Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.715388Z", "completed_at": "2025-02-21T08:00:42.715395Z"}], "thread_id": "Thread-1", "execution_time": 0.006732463836669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_rfm_customerid.038c7b69a4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.718189Z", "completed_at": "2025-02-21T08:00:42.729155Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.729731Z", "completed_at": "2025-02-21T08:00:42.729738Z"}], "thread_id": "Thread-1", "execution_time": 0.012944459915161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_details", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), ranked_customers AS (\n    SELECT \n        rc.CustomerID,\n        rc.Country, \n        MAX(CAST(rc.InvoiceDate AS TIMESTAMP_NTZ)) AS last_purchase_date,  \n        cs.customer_segment,\n        ROW_NUMBER() OVER (\n            PARTITION BY rc.CustomerID \n            ORDER BY MAX(rc.InvoiceDate) DESC\n        ) AS row_num  \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed rc\n    JOIN __dbt__cte__customer_segmentation cs \n        ON rc.CustomerID = cs.CustomerID\n    WHERE rc.CustomerID IS NOT NULL  \n    GROUP BY rc.CustomerID, rc.Country, cs.customer_segment\n)\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM ranked_customers\nWHERE row_num = 1", "relation_name": "Retail_Analytics_dbt.DEV.customer_details", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.732428Z", "completed_at": "2025-02-21T08:00:42.740549Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.741137Z", "completed_at": "2025-02-21T08:00:42.741144Z"}], "thread_id": "Thread-1", "execution_time": 0.01003575325012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_segmentation_customer_segment__Low_Value__High_Value__Medium_Value.c217f41f8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from __dbt__cte__customer_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.743927Z", "completed_at": "2025-02-21T08:00:42.753302Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.753894Z", "completed_at": "2025-02-21T08:00:42.753902Z"}], "thread_id": "Thread-1", "execution_time": 0.011341094970703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_segmentation_total_spent__0.4ffd3970f1", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_spent >= 0\n)\n as expression\n\n\n    from __dbt__cte__customer_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.756626Z", "completed_at": "2025-02-21T08:00:42.762307Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.762899Z", "completed_at": "2025-02-21T08:00:42.762906Z"}], "thread_id": "Thread-1", "execution_time": 0.007617950439453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customer_segment.43a922a178", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customer_segment\nfrom __dbt__cte__customer_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.765611Z", "completed_at": "2025-02-21T08:00:42.771213Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.771792Z", "completed_at": "2025-02-21T08:00:42.771800Z"}], "thread_id": "Thread-1", "execution_time": 0.0075261592864990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customerid.d076fa21fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customerid\nfrom __dbt__cte__customer_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.774510Z", "completed_at": "2025-02-21T08:00:42.780228Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.780809Z", "completed_at": "2025-02-21T08:00:42.780817Z"}], "thread_id": "Thread-1", "execution_time": 0.007665395736694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_total_spent.b1f375fd04", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select total_spent\nfrom __dbt__cte__customer_segmentation\nwhere total_spent is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.783511Z", "completed_at": "2025-02-21T08:00:42.791003Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.791585Z", "completed_at": "2025-02-21T08:00:42.791593Z"}], "thread_id": "Thread-1", "execution_time": 0.009406566619873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_segmentation_customerid.87af06908f", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__customer_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.794256Z", "completed_at": "2025-02-21T08:00:42.799212Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.799887Z", "completed_at": "2025-02-21T08:00:42.799895Z"}], "thread_id": "Thread-1", "execution_time": 0.006942272186279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_customerid.5c6a0d807a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.802634Z", "completed_at": "2025-02-21T08:00:42.807436Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.808022Z", "completed_at": "2025-02-21T08:00:42.808029Z"}], "thread_id": "Thread-1", "execution_time": 0.006745100021362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoicedate.9b5164cbca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.810730Z", "completed_at": "2025-02-21T08:00:42.815656Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.816223Z", "completed_at": "2025-02-21T08:00:42.816231Z"}], "thread_id": "Thread-1", "execution_time": 0.006842851638793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoiceno.814023b4b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.818945Z", "completed_at": "2025-02-21T08:00:42.879822Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.880407Z", "completed_at": "2025-02-21T08:00:42.880416Z"}], "thread_id": "Thread-1", "execution_time": 0.06279182434082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_quantity.5941470935", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.883168Z", "completed_at": "2025-02-21T08:00:42.888050Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.888631Z", "completed_at": "2025-02-21T08:00:42.888638Z"}], "thread_id": "Thread-1", "execution_time": 0.006803750991821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_stockcode.7cd988ce1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.891284Z", "completed_at": "2025-02-21T08:00:42.896125Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.896717Z", "completed_at": "2025-02-21T08:00:42.896725Z"}], "thread_id": "Thread-1", "execution_time": 0.006730318069458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_total_amount.a53a0c6b73", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.899400Z", "completed_at": "2025-02-21T08:00:42.904198Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.904782Z", "completed_at": "2025-02-21T08:00:42.904789Z"}], "thread_id": "Thread-1", "execution_time": 0.006656646728515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_unitprice.5ed09c21d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.907506Z", "completed_at": "2025-02-21T08:00:42.913092Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.913674Z", "completed_at": "2025-02-21T08:00:42.913681Z"}], "thread_id": "Thread-1", "execution_time": 0.007529020309448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_quantity.65c560aef0", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.916470Z", "completed_at": "2025-02-21T08:00:42.921047Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.921631Z", "completed_at": "2025-02-21T08:00:42.921639Z"}], "thread_id": "Thread-1", "execution_time": 0.006600618362426758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_unitprice.23717a8a80", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.924272Z", "completed_at": "2025-02-21T08:00:42.929071Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.929669Z", "completed_at": "2025-02-21T08:00:42.929676Z"}], "thread_id": "Thread-1", "execution_time": 0.0066912174224853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_facts_sales_invoiceno.72b8d42de3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.932356Z", "completed_at": "2025-02-21T08:00:42.937491Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.938102Z", "completed_at": "2025-02-21T08:00:42.938109Z"}], "thread_id": "Thread-1", "execution_time": 0.0070798397064208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_rfm_segmentation_customer_segment__Lost_Customers__Others__New_Customers__At_Risk_Customers__Loyal_Customers__Best_Customers.6591bc65e5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Lost Customers','Others','New Customers','At Risk Customers','Loyal Customers','Best Customers'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.940873Z", "completed_at": "2025-02-21T08:00:42.947182Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.947781Z", "completed_at": "2025-02-21T08:00:42.947789Z"}], "thread_id": "Thread-1", "execution_time": 0.008292198181152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_frequency_score__5__1.83da3ad10d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.950551Z", "completed_at": "2025-02-21T08:00:42.955805Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.956376Z", "completed_at": "2025-02-21T08:00:42.956384Z"}], "thread_id": "Thread-1", "execution_time": 0.00720977783203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_monetary_score__5__1.9b621f7d6d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.959105Z", "completed_at": "2025-02-21T08:00:42.964312Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.964905Z", "completed_at": "2025-02-21T08:00:42.964913Z"}], "thread_id": "Thread-1", "execution_time": 0.0070798397064208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_recency_score__5__1.5dbb00febf", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.967685Z", "completed_at": "2025-02-21T08:00:42.972937Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.973508Z", "completed_at": "2025-02-21T08:00:42.973516Z"}], "thread_id": "Thread-1", "execution_time": 0.0072324275970458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_rfm_total_score__15__3.c89dd43d37", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.976213Z", "completed_at": "2025-02-21T08:00:42.981977Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.982562Z", "completed_at": "2025-02-21T08:00:42.982570Z"}], "thread_id": "Thread-1", "execution_time": 0.007616281509399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customer_segment.bc3b848ac9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.985225Z", "completed_at": "2025-02-21T08:00:42.990144Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.990746Z", "completed_at": "2025-02-21T08:00:42.990754Z"}], "thread_id": "Thread-1", "execution_time": 0.006817340850830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customerid.50d071bf39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:42.993433Z", "completed_at": "2025-02-21T08:00:42.998302Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:42.998891Z", "completed_at": "2025-02-21T08:00:42.998899Z"}], "thread_id": "Thread-1", "execution_time": 0.006777524948120117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency.7a592f92e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.001583Z", "completed_at": "2025-02-21T08:00:43.006383Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.006970Z", "completed_at": "2025-02-21T08:00:43.006978Z"}], "thread_id": "Thread-1", "execution_time": 0.0066645145416259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency_score.cf789cfaf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.009658Z", "completed_at": "2025-02-21T08:00:43.015570Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.016137Z", "completed_at": "2025-02-21T08:00:43.016145Z"}], "thread_id": "Thread-1", "execution_time": 0.007811784744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_score.3c79b405c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.018793Z", "completed_at": "2025-02-21T08:00:43.023572Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.024138Z", "completed_at": "2025-02-21T08:00:43.024146Z"}], "thread_id": "Thread-1", "execution_time": 0.006596565246582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_value.6f15dbf8c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.026841Z", "completed_at": "2025-02-21T08:00:43.031690Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.032257Z", "completed_at": "2025-02-21T08:00:43.032264Z"}], "thread_id": "Thread-1", "execution_time": 0.006731748580932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency.da8a73e831", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.034981Z", "completed_at": "2025-02-21T08:00:43.039845Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.040420Z", "completed_at": "2025-02-21T08:00:43.040428Z"}], "thread_id": "Thread-1", "execution_time": 0.006756305694580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency_score.bb262aa125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.043138Z", "completed_at": "2025-02-21T08:00:43.049243Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.049821Z", "completed_at": "2025-02-21T08:00:43.049829Z"}], "thread_id": "Thread-1", "execution_time": 0.007994890213012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_rfm_total_score.fdbc0e1a76", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.052506Z", "completed_at": "2025-02-21T08:00:43.057196Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.057788Z", "completed_at": "2025-02-21T08:00:43.057796Z"}], "thread_id": "Thread-1", "execution_time": 0.006600856781005859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_frequency.7b9a8a5622", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.060449Z", "completed_at": "2025-02-21T08:00:43.065187Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.065780Z", "completed_at": "2025-02-21T08:00:43.065787Z"}], "thread_id": "Thread-1", "execution_time": 0.006633758544921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_monetary_value.a891bd8f5e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.068417Z", "completed_at": "2025-02-21T08:00:43.073142Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.073736Z", "completed_at": "2025-02-21T08:00:43.073744Z"}], "thread_id": "Thread-1", "execution_time": 0.0066127777099609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_recency.aaf271ec1c", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.076385Z", "completed_at": "2025-02-21T08:00:43.081130Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.081716Z", "completed_at": "2025-02-21T08:00:43.081724Z"}], "thread_id": "Thread-1", "execution_time": 0.00656890869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_rfm_segmentation_customerid.74e9ada8ce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.084409Z", "completed_at": "2025-02-21T08:00:43.090469Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.091052Z", "completed_at": "2025-02-21T08:00:43.091060Z"}], "thread_id": "Thread-1", "execution_time": 0.007974624633789062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_month.d21efcf3b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.093749Z", "completed_at": "2025-02-21T08:00:43.098612Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.099208Z", "completed_at": "2025-02-21T08:00:43.099216Z"}], "thread_id": "Thread-1", "execution_time": 0.00677180290222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_orders.28cf895dd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_orders\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.101920Z", "completed_at": "2025-02-21T08:00:43.106749Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.107310Z", "completed_at": "2025-02-21T08:00:43.107317Z"}], "thread_id": "Thread-1", "execution_time": 0.006638288497924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_sales.62238b2d9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_sales is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.109931Z", "completed_at": "2025-02-21T08:00:43.114663Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.115226Z", "completed_at": "2025-02-21T08:00:43.115233Z"}], "thread_id": "Thread-1", "execution_time": 0.006525516510009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_orders.bcc49b526e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_orders <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.117861Z", "completed_at": "2025-02-21T08:00:43.123511Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.124094Z", "completed_at": "2025-02-21T08:00:43.124102Z"}], "thread_id": "Thread-1", "execution_time": 0.007462263107299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_sales.277d5be8a8", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_sales <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.126748Z", "completed_at": "2025-02-21T08:00:43.131575Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.132146Z", "completed_at": "2025-02-21T08:00:43.132153Z"}], "thread_id": "Thread-1", "execution_time": 0.00671839714050293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_sales_performance_month.8f24859e00", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    month as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is not null\ngroup by month\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.134868Z", "completed_at": "2025-02-21T08:00:43.138345Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.138940Z", "completed_at": "2025-02-21T08:00:43.138948Z"}], "thread_id": "Thread-1", "execution_time": 0.005371809005737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_assignment_1.customer_data_snapshot", "compiled": true, "compiled_code": "\n\n\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM Retail_Analytics_dbt.DEV.customer_details\n", "relation_name": "Retail_Analytics_dbt.DEV.customer_data_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.141585Z", "completed_at": "2025-02-21T08:00:43.146622Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.147192Z", "completed_at": "2025-02-21T08:00:43.147199Z"}], "thread_id": "Thread-1", "execution_time": 0.006864786148071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_details_customer_segment__Low_Value__High_Value__Medium_Value.4531c05819", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.customer_details\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.149802Z", "completed_at": "2025-02-21T08:00:43.155637Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.156201Z", "completed_at": "2025-02-21T08:00:43.156208Z"}], "thread_id": "Thread-1", "execution_time": 0.007616758346557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_country.e482842f53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.158831Z", "completed_at": "2025-02-21T08:00:43.163674Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.164239Z", "completed_at": "2025-02-21T08:00:43.164246Z"}], "thread_id": "Thread-1", "execution_time": 0.006651401519775391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customer_segment.04ce2e4c5a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.166857Z", "completed_at": "2025-02-21T08:00:43.171668Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.172231Z", "completed_at": "2025-02-21T08:00:43.172238Z"}], "thread_id": "Thread-1", "execution_time": 0.006608486175537109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customerid.06b05eda46", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.174841Z", "completed_at": "2025-02-21T08:00:43.179696Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.180253Z", "completed_at": "2025-02-21T08:00:43.180261Z"}], "thread_id": "Thread-1", "execution_time": 0.006634235382080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_last_purchase_date.e3942b63a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_purchase_date\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere last_purchase_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:00:43.182852Z", "completed_at": "2025-02-21T08:00:43.188522Z"}, {"name": "execute", "started_at": "2025-02-21T08:00:43.189104Z", "completed_at": "2025-02-21T08:00:43.189112Z"}], "thread_id": "Thread-1", "execution_time": 0.007477521896362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_details_customerid.77f44ca40a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 3.25645112991333, "args": {"state_modified_compare_vars": false, "empty_catalog": false, "exclude": [], "vars": {}, "write_json": true, "invocation_command": "dbt docs generate", "source_freshness_run_project_hooks": false, "require_nested_cumulative_type_params": false, "cache_selected_only": false, "partial_parse_file_diff": true, "log_format": "default", "use_colors": true, "state_modified_compare_more_unrendered_values": false, "log_path": "/home/runner/work/dbt_assignment_1/dbt_assignment_1/logs", "project_dir": "/home/runner/work/dbt_assignment_1/dbt_assignment_1", "log_level_file": "debug", "print": true, "static_parser": true, "macro_debugging": false, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": "/home/runner/.dbt", "compile": true, "require_resource_names_without_spaces": false, "strict_mode": false, "warn_error_options": {"include": [], "exclude": []}, "require_batched_execution_for_custom_microbatch_strategy": false, "require_yaml_configuration_for_mf_time_spines": false, "static": false, "indirect_selection": "eager", "populate_cache": true, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "quiet": false, "show_resource_report": false, "version_check": true, "favor_state": false, "which": "generate", "partial_parse": true, "log_file_max_bytes": 10485760, "defer": false, "select": [], "printer_width": 80, "send_anonymous_usage_stats": true, "log_format_file": "debug", "introspect": true}}