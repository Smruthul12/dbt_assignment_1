{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-21T08:27:25.655597Z", "invocation_id": "6350844c-399f-4b59-8760-c2306576f23d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.417300Z", "completed_at": "2025-02-21T08:27:24.428209Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.428802Z", "completed_at": "2025-02-21T08:27:24.428819Z"}], "thread_id": "Thread-1", "execution_time": 0.012914419174194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.raw_retail", "compiled": true, "compiled_code": "\n\nWITH raw_retail AS (\n    SELECT\n        *\n    FROM\n        Retail_Analytics_dbt.ecommerce.raw_retail_data\n)\nSELECT\n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice AS UnitPrice_str,\n    CustomerID,\n    Country\nFROM\n    raw_retail", "relation_name": "Retail_Analytics_dbt.DEV.raw_retail", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.431846Z", "completed_at": "2025-02-21T08:27:24.440601Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.441189Z", "completed_at": "2025-02-21T08:27:24.441202Z"}], "thread_id": "Thread-1", "execution_time": 0.010712146759033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.retail_cleansed", "compiled": true, "compiled_code": "\n\nWITH filtered_data AS (\n    SELECT\n        InvoiceNo,\n        StockCode,\n        TRIM(UPPER(Description)) AS Description,\n        Quantity,\n        CAST(InvoiceDate AS DATE) AS InvoiceDate,  \n        CASE \n            WHEN UnitPrice_str REGEXP '^[0-9]+(\\.[0-9]+)?$' \n                 AND CAST(UnitPrice_str AS FLOAT) > 0 \n            THEN CAST(UnitPrice_str AS FLOAT)\n            ELSE NULL  \n        END AS UnitPrice,\n        CustomerID,\n        TRIM(UPPER(Country)) AS Country,\n        ROW_NUMBER() OVER (PARTITION BY InvoiceNo ORDER BY InvoiceDate DESC) AS row_num\n    FROM Retail_Analytics_dbt.DEV.raw_retail\n    WHERE \n        InvoiceNo IS NOT NULL \n        AND CustomerID IS NOT NULL \n        AND Description IS NOT NULL \n        AND Description REGEXP '^[A-Za-z0-9 ]+$'\n        AND Quantity > 0\n\n        \n        AND InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.retail_cleansed)  \n        \n)\n\nSELECT \n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice,\n    CustomerID,\n    Country\nFROM filtered_data\nWHERE row_num = 1 \nAND UnitPrice IS NOT NULL", "relation_name": "Retail_Analytics_dbt.DEV.retail_cleansed", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.444513Z", "completed_at": "2025-02-21T08:27:24.449151Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.449734Z", "completed_at": "2025-02-21T08:27:24.449743Z"}], "thread_id": "Thread-1", "execution_time": 0.00649714469909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_rfm", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency,\n        frequency,\n        monetary_value,\n        NTILE(5) OVER (ORDER BY recency DESC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency ASC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value ASC) AS monetary_score\n    FROM rfm_base\n)\n\nSELECT \n    CustomerID,\n    recency,\n    frequency,\n    monetary_value,\n    recency_score,\n    frequency_score,\n    monetary_score,\n    recency_score + frequency_score + monetary_score AS rfm_total_score\nFROM rfm_scores", "relation_name": "Retail_Analytics_dbt.DEV.customer_rfm", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.459962Z", "completed_at": "2025-02-21T08:27:24.465352Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.465947Z", "completed_at": "2025-02-21T08:27:24.465957Z"}], "thread_id": "Thread-1", "execution_time": 0.0073070526123046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.facts_sales", "compiled": true, "compiled_code": "\n\nWITH new_sales AS (\n    SELECT \n        InvoiceNo,\n        InvoiceDate,\n        CustomerID,\n        StockCode,\n        Quantity,\n        UnitPrice,\n        Quantity * UnitPrice AS total_amount\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    \n    \n    WHERE InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.facts_sales)\n    \n)\n\nSELECT * FROM new_sales", "relation_name": "Retail_Analytics_dbt.DEV.facts_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.468870Z", "completed_at": "2025-02-21T08:27:24.474430Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.474993Z", "completed_at": "2025-02-21T08:27:24.475004Z"}], "thread_id": "Thread-1", "execution_time": 0.007442474365234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.rfm_segmentation", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    WHERE CustomerID IS NOT NULL\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency, \n        frequency,\n        monetary_value,\n\n        NTILE(5) OVER (ORDER BY recency ASC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency DESC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value DESC) AS monetary_score\n\n    FROM rfm_base\n),\n\nrfm_segmentation AS (\n    SELECT \n        CustomerID,\n        recency,\n        frequency,\n        monetary_value,\n        recency_score,\n        frequency_score,\n        monetary_score,\n        \n        recency_score + frequency_score + monetary_score AS rfm_total_score,\n\n        CASE \n            WHEN recency_score >= 4 AND frequency_score >= 4 AND monetary_score >= 4 THEN 'Best Customers'\n            WHEN recency_score >= 3 AND frequency_score >= 3 AND monetary_score >= 3 THEN 'Loyal Customers'\n            WHEN recency_score >= 3 AND frequency_score <= 2 THEN 'New Customers'\n            WHEN recency_score <= 2 AND frequency_score >= 4 THEN 'At Risk Customers'\n            WHEN recency_score <= 2 AND frequency_score <= 2 THEN 'Lost Customers'\n            ELSE 'Others'\n        END AS customer_segment\n    FROM rfm_scores\n)\n\nSELECT * FROM rfm_segmentation", "relation_name": "Retail_Analytics_dbt.DEV.rfm_segmentation", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.477826Z", "completed_at": "2025-02-21T08:27:24.482619Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.483196Z", "completed_at": "2025-02-21T08:27:24.483205Z"}], "thread_id": "Thread-1", "execution_time": 0.006825685501098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.sales_performance", "compiled": true, "compiled_code": "-- sales performance by month\n\n\nWITH sales AS (\n    SELECT\n        DATE_TRUNC('month', InvoiceDate) AS month,\n        SUM(Quantity * UnitPrice) AS total_sales,\n        COUNT(DISTINCT InvoiceNo) AS total_orders\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY 1\n)\n\nSELECT \n    month,\n    total_sales,\n    total_orders\nFROM sales\nORDER BY month DESC", "relation_name": "Retail_Analytics_dbt.DEV.sales_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.485980Z", "completed_at": "2025-02-21T08:27:24.492332Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.492937Z", "completed_at": "2025-02-21T08:27:24.492947Z"}], "thread_id": "Thread-1", "execution_time": 0.00829458236694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_country___A_Z_.a56523768c", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(country, '^[A-Z ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.495753Z", "completed_at": "2025-02-21T08:27:24.501453Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.502029Z", "completed_at": "2025-02-21T08:27:24.502039Z"}], "thread_id": "Thread-1", "execution_time": 0.007678508758544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_description___A_Za_z0_9_.c511af4a01", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(description, '^[A-Za-z0-9 ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.504859Z", "completed_at": "2025-02-21T08:27:24.518428Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.519009Z", "completed_at": "2025-02-21T08:27:24.519023Z"}], "thread_id": "Thread-1", "execution_time": 0.015566349029541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_country.6f766fcede", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.521864Z", "completed_at": "2025-02-21T08:27:24.527629Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.528192Z", "completed_at": "2025-02-21T08:27:24.528202Z"}], "thread_id": "Thread-1", "execution_time": 0.007655143737792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_customerid.ee2eb7401f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.530944Z", "completed_at": "2025-02-21T08:27:24.536311Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.536921Z", "completed_at": "2025-02-21T08:27:24.536930Z"}], "thread_id": "Thread-1", "execution_time": 0.007306337356567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_description.f7892dd595", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect description\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere description is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.539669Z", "completed_at": "2025-02-21T08:27:24.545139Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.545720Z", "completed_at": "2025-02-21T08:27:24.545730Z"}], "thread_id": "Thread-1", "execution_time": 0.007352352142333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoicedate.158713fed2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.548457Z", "completed_at": "2025-02-21T08:27:24.555151Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.555741Z", "completed_at": "2025-02-21T08:27:24.555751Z"}], "thread_id": "Thread-1", "execution_time": 0.008648872375488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoiceno.4de3fe5244", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.558492Z", "completed_at": "2025-02-21T08:27:24.563929Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.564537Z", "completed_at": "2025-02-21T08:27:24.564546Z"}], "thread_id": "Thread-1", "execution_time": 0.00741124153137207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_quantity.c66a8f7258", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.567262Z", "completed_at": "2025-02-21T08:27:24.572595Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.573173Z", "completed_at": "2025-02-21T08:27:24.573181Z"}], "thread_id": "Thread-1", "execution_time": 0.0072536468505859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_stockcode.a80aad6f0d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.575947Z", "completed_at": "2025-02-21T08:27:24.581199Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.581834Z", "completed_at": "2025-02-21T08:27:24.581843Z"}], "thread_id": "Thread-1", "execution_time": 0.007171630859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_unitprice.c8e43c7c7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.584595Z", "completed_at": "2025-02-21T08:27:24.589768Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.590335Z", "completed_at": "2025-02-21T08:27:24.590344Z"}], "thread_id": "Thread-1", "execution_time": 0.007135629653930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_quantity.ebbe111451", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.593076Z", "completed_at": "2025-02-21T08:27:24.599628Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.600189Z", "completed_at": "2025-02-21T08:27:24.600198Z"}], "thread_id": "Thread-1", "execution_time": 0.008441448211669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_unitprice.702e3bce82", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.602913Z", "completed_at": "2025-02-21T08:27:24.610686Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.611251Z", "completed_at": "2025-02-21T08:27:24.611261Z"}], "thread_id": "Thread-1", "execution_time": 0.009619951248168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_retail_cleansed_invoiceno.752ff487db", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.614074Z", "completed_at": "2025-02-21T08:27:24.619976Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.620575Z", "completed_at": "2025-02-21T08:27:24.620584Z"}], "thread_id": "Thread-1", "execution_time": 0.007889032363891602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_frequency_score__5__1.2812983e24", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.623411Z", "completed_at": "2025-02-21T08:27:24.629239Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.629854Z", "completed_at": "2025-02-21T08:27:24.629863Z"}], "thread_id": "Thread-1", "execution_time": 0.007870912551879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_monetary_score__5__1.01604b14de", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.632673Z", "completed_at": "2025-02-21T08:27:24.639561Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.640130Z", "completed_at": "2025-02-21T08:27:24.640139Z"}], "thread_id": "Thread-1", "execution_time": 0.008857250213623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_recency_score__5__1.2025cc414f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.642939Z", "completed_at": "2025-02-21T08:27:24.648783Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.649360Z", "completed_at": "2025-02-21T08:27:24.649369Z"}], "thread_id": "Thread-1", "execution_time": 0.007815361022949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_rfm_total_score__15__3.0233537330", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.652131Z", "completed_at": "2025-02-21T08:27:24.657316Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.657944Z", "completed_at": "2025-02-21T08:27:24.657953Z"}], "thread_id": "Thread-1", "execution_time": 0.0071675777435302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_customerid.8756c1c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.660721Z", "completed_at": "2025-02-21T08:27:24.666116Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.666716Z", "completed_at": "2025-02-21T08:27:24.666725Z"}], "thread_id": "Thread-1", "execution_time": 0.0073206424713134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency.4f6126998b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.669439Z", "completed_at": "2025-02-21T08:27:24.675818Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.676420Z", "completed_at": "2025-02-21T08:27:24.676429Z"}], "thread_id": "Thread-1", "execution_time": 0.008332967758178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency_score.ac5407a1e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.679138Z", "completed_at": "2025-02-21T08:27:24.684335Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.684923Z", "completed_at": "2025-02-21T08:27:24.684932Z"}], "thread_id": "Thread-1", "execution_time": 0.007134675979614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_score.c8961d5f9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.687637Z", "completed_at": "2025-02-21T08:27:24.692823Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.693402Z", "completed_at": "2025-02-21T08:27:24.693410Z"}], "thread_id": "Thread-1", "execution_time": 0.007031679153442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_value.1afb87803e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.696091Z", "completed_at": "2025-02-21T08:27:24.701329Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.701909Z", "completed_at": "2025-02-21T08:27:24.701917Z"}], "thread_id": "Thread-1", "execution_time": 0.0070896148681640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency.ce57eb9baf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.704629Z", "completed_at": "2025-02-21T08:27:24.710953Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.711537Z", "completed_at": "2025-02-21T08:27:24.711546Z"}], "thread_id": "Thread-1", "execution_time": 0.008234024047851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency_score.da6e261a1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.714242Z", "completed_at": "2025-02-21T08:27:24.719488Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.720056Z", "completed_at": "2025-02-21T08:27:24.720064Z"}], "thread_id": "Thread-1", "execution_time": 0.007141828536987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_rfm_total_score.a359721407", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.722810Z", "completed_at": "2025-02-21T08:27:24.727697Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.728256Z", "completed_at": "2025-02-21T08:27:24.728265Z"}], "thread_id": "Thread-1", "execution_time": 0.006807804107666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_frequency.d2fca0de8b", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.730997Z", "completed_at": "2025-02-21T08:27:24.735960Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.736552Z", "completed_at": "2025-02-21T08:27:24.736560Z"}], "thread_id": "Thread-1", "execution_time": 0.0069010257720947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_monetary_value.2a5a7cba3d", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.739237Z", "completed_at": "2025-02-21T08:27:24.745427Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.745999Z", "completed_at": "2025-02-21T08:27:24.746008Z"}], "thread_id": "Thread-1", "execution_time": 0.008089542388916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_recency.3a739403c4", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.749206Z", "completed_at": "2025-02-21T08:27:24.754694Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.755254Z", "completed_at": "2025-02-21T08:27:24.755262Z"}], "thread_id": "Thread-1", "execution_time": 0.007854700088500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_rfm_customerid.038c7b69a4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.758028Z", "completed_at": "2025-02-21T08:27:24.769612Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.770180Z", "completed_at": "2025-02-21T08:27:24.770190Z"}], "thread_id": "Thread-1", "execution_time": 0.013535499572753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_details", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), ranked_customers AS (\n    SELECT \n        rc.CustomerID,\n        rc.Country, \n        MAX(CAST(rc.InvoiceDate AS TIMESTAMP_NTZ)) AS last_purchase_date,  \n        cs.customer_segment,\n        ROW_NUMBER() OVER (\n            PARTITION BY rc.CustomerID \n            ORDER BY MAX(rc.InvoiceDate) DESC\n        ) AS row_num  \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed rc\n    JOIN __dbt__cte__customer_segmentation cs \n        ON rc.CustomerID = cs.CustomerID\n    WHERE rc.CustomerID IS NOT NULL  \n    GROUP BY rc.CustomerID, rc.Country, cs.customer_segment\n)\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM ranked_customers\nWHERE row_num = 1", "relation_name": "Retail_Analytics_dbt.DEV.customer_details", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.772938Z", "completed_at": "2025-02-21T08:27:24.781657Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.782236Z", "completed_at": "2025-02-21T08:27:24.782245Z"}], "thread_id": "Thread-1", "execution_time": 0.010644197463989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_segmentation_customer_segment__Low_Value__High_Value__Medium_Value.c217f41f8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from __dbt__cte__customer_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.785064Z", "completed_at": "2025-02-21T08:27:24.795572Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.796148Z", "completed_at": "2025-02-21T08:27:24.796158Z"}], "thread_id": "Thread-1", "execution_time": 0.012472391128540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_segmentation_total_spent__0.4ffd3970f1", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_spent >= 0\n)\n as expression\n\n\n    from __dbt__cte__customer_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.798949Z", "completed_at": "2025-02-21T08:27:24.805136Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.805725Z", "completed_at": "2025-02-21T08:27:24.805734Z"}], "thread_id": "Thread-1", "execution_time": 0.008148193359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customer_segment.43a922a178", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customer_segment\nfrom __dbt__cte__customer_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.808439Z", "completed_at": "2025-02-21T08:27:24.814679Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.815244Z", "completed_at": "2025-02-21T08:27:24.815252Z"}], "thread_id": "Thread-1", "execution_time": 0.008143186569213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customerid.d076fa21fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customerid\nfrom __dbt__cte__customer_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.818025Z", "completed_at": "2025-02-21T08:27:24.824274Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.824925Z", "completed_at": "2025-02-21T08:27:24.824935Z"}], "thread_id": "Thread-1", "execution_time": 0.008303403854370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_total_spent.b1f375fd04", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select total_spent\nfrom __dbt__cte__customer_segmentation\nwhere total_spent is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.827653Z", "completed_at": "2025-02-21T08:27:24.835934Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.836521Z", "completed_at": "2025-02-21T08:27:24.836530Z"}], "thread_id": "Thread-1", "execution_time": 0.010188102722167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_segmentation_customerid.87af06908f", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__customer_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.839283Z", "completed_at": "2025-02-21T08:27:24.844351Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.844942Z", "completed_at": "2025-02-21T08:27:24.844949Z"}], "thread_id": "Thread-1", "execution_time": 0.007033586502075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_customerid.5c6a0d807a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.847653Z", "completed_at": "2025-02-21T08:27:24.852768Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.853329Z", "completed_at": "2025-02-21T08:27:24.853338Z"}], "thread_id": "Thread-1", "execution_time": 0.006966590881347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoicedate.9b5164cbca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.856043Z", "completed_at": "2025-02-21T08:27:24.861182Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.861765Z", "completed_at": "2025-02-21T08:27:24.861773Z"}], "thread_id": "Thread-1", "execution_time": 0.0070362091064453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoiceno.814023b4b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.864500Z", "completed_at": "2025-02-21T08:27:24.943518Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.944102Z", "completed_at": "2025-02-21T08:27:24.944119Z"}], "thread_id": "Thread-1", "execution_time": 0.08099222183227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_quantity.5941470935", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.946937Z", "completed_at": "2025-02-21T08:27:24.952190Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.952792Z", "completed_at": "2025-02-21T08:27:24.952801Z"}], "thread_id": "Thread-1", "execution_time": 0.0071964263916015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_stockcode.7cd988ce1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.955526Z", "completed_at": "2025-02-21T08:27:24.960757Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.961325Z", "completed_at": "2025-02-21T08:27:24.961333Z"}], "thread_id": "Thread-1", "execution_time": 0.0071718692779541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_total_amount.a53a0c6b73", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.964106Z", "completed_at": "2025-02-21T08:27:24.969196Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.969800Z", "completed_at": "2025-02-21T08:27:24.969807Z"}], "thread_id": "Thread-1", "execution_time": 0.006997108459472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_unitprice.5ed09c21d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.972608Z", "completed_at": "2025-02-21T08:27:24.978668Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.979239Z", "completed_at": "2025-02-21T08:27:24.979247Z"}], "thread_id": "Thread-1", "execution_time": 0.008047103881835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_quantity.65c560aef0", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.982044Z", "completed_at": "2025-02-21T08:27:24.986768Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.987331Z", "completed_at": "2025-02-21T08:27:24.987338Z"}], "thread_id": "Thread-1", "execution_time": 0.0067174434661865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_unitprice.23717a8a80", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.990090Z", "completed_at": "2025-02-21T08:27:24.994995Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:24.995570Z", "completed_at": "2025-02-21T08:27:24.995578Z"}], "thread_id": "Thread-1", "execution_time": 0.006839275360107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_facts_sales_invoiceno.72b8d42de3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:24.998256Z", "completed_at": "2025-02-21T08:27:25.003780Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.004358Z", "completed_at": "2025-02-21T08:27:25.004366Z"}], "thread_id": "Thread-1", "execution_time": 0.007435798645019531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_rfm_segmentation_customer_segment__Lost_Customers__Others__New_Customers__At_Risk_Customers__Loyal_Customers__Best_Customers.6591bc65e5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Lost Customers','Others','New Customers','At Risk Customers','Loyal Customers','Best Customers'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.007171Z", "completed_at": "2025-02-21T08:27:25.013822Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.014408Z", "completed_at": "2025-02-21T08:27:25.014416Z"}], "thread_id": "Thread-1", "execution_time": 0.00860595703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_frequency_score__5__1.83da3ad10d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.017174Z", "completed_at": "2025-02-21T08:27:25.022613Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.023183Z", "completed_at": "2025-02-21T08:27:25.023191Z"}], "thread_id": "Thread-1", "execution_time": 0.00736546516418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_monetary_score__5__1.9b621f7d6d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.025917Z", "completed_at": "2025-02-21T08:27:25.031420Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.032058Z", "completed_at": "2025-02-21T08:27:25.032065Z"}], "thread_id": "Thread-1", "execution_time": 0.007465362548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_recency_score__5__1.5dbb00febf", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.035056Z", "completed_at": "2025-02-21T08:27:25.041222Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.041830Z", "completed_at": "2025-02-21T08:27:25.041838Z"}], "thread_id": "Thread-1", "execution_time": 0.008280038833618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_rfm_total_score__15__3.c89dd43d37", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.044634Z", "completed_at": "2025-02-21T08:27:25.050999Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.051579Z", "completed_at": "2025-02-21T08:27:25.051588Z"}], "thread_id": "Thread-1", "execution_time": 0.008339881896972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customer_segment.bc3b848ac9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.054284Z", "completed_at": "2025-02-21T08:27:25.059416Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.059990Z", "completed_at": "2025-02-21T08:27:25.059998Z"}], "thread_id": "Thread-1", "execution_time": 0.007033348083496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customerid.50d071bf39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.062688Z", "completed_at": "2025-02-21T08:27:25.067874Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.068471Z", "completed_at": "2025-02-21T08:27:25.068480Z"}], "thread_id": "Thread-1", "execution_time": 0.00709223747253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency.7a592f92e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.071202Z", "completed_at": "2025-02-21T08:27:25.076323Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.076909Z", "completed_at": "2025-02-21T08:27:25.076916Z"}], "thread_id": "Thread-1", "execution_time": 0.007056474685668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency_score.cf789cfaf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.079676Z", "completed_at": "2025-02-21T08:27:25.085958Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.086538Z", "completed_at": "2025-02-21T08:27:25.086546Z"}], "thread_id": "Thread-1", "execution_time": 0.00826883316040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_score.3c79b405c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.089252Z", "completed_at": "2025-02-21T08:27:25.094267Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.094860Z", "completed_at": "2025-02-21T08:27:25.094869Z"}], "thread_id": "Thread-1", "execution_time": 0.006955385208129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_value.6f15dbf8c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.097618Z", "completed_at": "2025-02-21T08:27:25.102745Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.103309Z", "completed_at": "2025-02-21T08:27:25.103317Z"}], "thread_id": "Thread-1", "execution_time": 0.007076263427734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency.da8a73e831", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.106052Z", "completed_at": "2025-02-21T08:27:25.111135Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.111716Z", "completed_at": "2025-02-21T08:27:25.111724Z"}], "thread_id": "Thread-1", "execution_time": 0.007005929946899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency_score.bb262aa125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.114542Z", "completed_at": "2025-02-21T08:27:25.120843Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.121414Z", "completed_at": "2025-02-21T08:27:25.121422Z"}], "thread_id": "Thread-1", "execution_time": 0.008295297622680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_rfm_total_score.fdbc0e1a76", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.124092Z", "completed_at": "2025-02-21T08:27:25.128923Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.129541Z", "completed_at": "2025-02-21T08:27:25.129549Z"}], "thread_id": "Thread-1", "execution_time": 0.006755352020263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_frequency.7b9a8a5622", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.132274Z", "completed_at": "2025-02-21T08:27:25.137119Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.137702Z", "completed_at": "2025-02-21T08:27:25.137710Z"}], "thread_id": "Thread-1", "execution_time": 0.00678563117980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_monetary_value.a891bd8f5e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.140410Z", "completed_at": "2025-02-21T08:27:25.145416Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.145992Z", "completed_at": "2025-02-21T08:27:25.146000Z"}], "thread_id": "Thread-1", "execution_time": 0.0069272518157958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_recency.aaf271ec1c", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.148667Z", "completed_at": "2025-02-21T08:27:25.153591Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.154174Z", "completed_at": "2025-02-21T08:27:25.154181Z"}], "thread_id": "Thread-1", "execution_time": 0.006745338439941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_rfm_segmentation_customerid.74e9ada8ce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.156871Z", "completed_at": "2025-02-21T08:27:25.163448Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.164017Z", "completed_at": "2025-02-21T08:27:25.164025Z"}], "thread_id": "Thread-1", "execution_time": 0.008452177047729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_month.d21efcf3b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.166739Z", "completed_at": "2025-02-21T08:27:25.171952Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.172595Z", "completed_at": "2025-02-21T08:27:25.172603Z"}], "thread_id": "Thread-1", "execution_time": 0.007178544998168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_orders.28cf895dd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_orders\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.175343Z", "completed_at": "2025-02-21T08:27:25.180659Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.181228Z", "completed_at": "2025-02-21T08:27:25.181235Z"}], "thread_id": "Thread-1", "execution_time": 0.007200002670288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_sales.62238b2d9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_sales is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.184124Z", "completed_at": "2025-02-21T08:27:25.190827Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.191595Z", "completed_at": "2025-02-21T08:27:25.191604Z"}], "thread_id": "Thread-1", "execution_time": 0.008904695510864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_orders.bcc49b526e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_orders <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.195312Z", "completed_at": "2025-02-21T08:27:25.204090Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.204893Z", "completed_at": "2025-02-21T08:27:25.204901Z"}], "thread_id": "Thread-1", "execution_time": 0.011191368103027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_sales.277d5be8a8", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_sales <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.208731Z", "completed_at": "2025-02-21T08:27:25.215794Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.216573Z", "completed_at": "2025-02-21T08:27:25.216582Z"}], "thread_id": "Thread-1", "execution_time": 0.009703397750854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_sales_performance_month.8f24859e00", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    month as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is not null\ngroup by month\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.220123Z", "completed_at": "2025-02-21T08:27:25.225512Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.226295Z", "completed_at": "2025-02-21T08:27:25.226304Z"}], "thread_id": "Thread-1", "execution_time": 0.007941007614135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_assignment_1.customer_data_snapshot", "compiled": true, "compiled_code": "\n\n\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM Retail_Analytics_dbt.DEV.customer_details\n", "relation_name": "Retail_Analytics_dbt.DEV.customer_data_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.230177Z", "completed_at": "2025-02-21T08:27:25.237812Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.238565Z", "completed_at": "2025-02-21T08:27:25.238573Z"}], "thread_id": "Thread-1", "execution_time": 0.01032114028930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_details_customer_segment__Low_Value__High_Value__Medium_Value.4531c05819", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.customer_details\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.241750Z", "completed_at": "2025-02-21T08:27:25.248137Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.248720Z", "completed_at": "2025-02-21T08:27:25.248728Z"}], "thread_id": "Thread-1", "execution_time": 0.008277654647827148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_country.e482842f53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.251476Z", "completed_at": "2025-02-21T08:27:25.256805Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.257368Z", "completed_at": "2025-02-21T08:27:25.257376Z"}], "thread_id": "Thread-1", "execution_time": 0.007286548614501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customer_segment.04ce2e4c5a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.260061Z", "completed_at": "2025-02-21T08:27:25.265202Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.265801Z", "completed_at": "2025-02-21T08:27:25.265809Z"}], "thread_id": "Thread-1", "execution_time": 0.007049560546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customerid.06b05eda46", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.268490Z", "completed_at": "2025-02-21T08:27:25.273605Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.274171Z", "completed_at": "2025-02-21T08:27:25.274179Z"}], "thread_id": "Thread-1", "execution_time": 0.007005929946899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_last_purchase_date.e3942b63a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_purchase_date\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere last_purchase_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T08:27:25.276918Z", "completed_at": "2025-02-21T08:27:25.282979Z"}, {"name": "execute", "started_at": "2025-02-21T08:27:25.283561Z", "completed_at": "2025-02-21T08:27:25.283570Z"}], "thread_id": "Thread-1", "execution_time": 0.007984638214111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_details_customerid.77f44ca40a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.6537528038024902, "args": {"strict_mode": false, "static": false, "require_resource_names_without_spaces": false, "log_format": "default", "write_json": true, "profiles_dir": "/home/runner/.dbt", "log_format_file": "debug", "exclude": [], "log_path": "/home/runner/work/dbt_assignment_1/dbt_assignment_1/logs", "static_parser": true, "use_colors_file": true, "log_level": "info", "show_resource_report": false, "print": true, "send_anonymous_usage_stats": true, "which": "generate", "state_modified_compare_vars": false, "select": [], "invocation_command": "dbt docs generate", "require_batched_execution_for_custom_microbatch_strategy": false, "require_nested_cumulative_type_params": false, "require_yaml_configuration_for_mf_time_spines": false, "favor_state": false, "printer_width": 80, "quiet": false, "partial_parse": true, "log_level_file": "debug", "introspect": true, "use_colors": true, "empty_catalog": false, "source_freshness_run_project_hooks": false, "version_check": true, "log_file_max_bytes": 10485760, "indirect_selection": "eager", "cache_selected_only": false, "macro_debugging": false, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "project_dir": "/home/runner/work/dbt_assignment_1/dbt_assignment_1", "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}, "compile": true, "defer": false, "partial_parse_file_diff": true, "populate_cache": true, "vars": {}}}