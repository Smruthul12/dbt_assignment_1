{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-21T07:10:43.654720Z", "invocation_id": "2d7e5482-073d-478a-8185-dd82ca959ad5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.378918Z", "completed_at": "2025-02-21T07:10:42.389290Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.389855Z", "completed_at": "2025-02-21T07:10:42.389886Z"}], "thread_id": "Thread-1", "execution_time": 0.012271404266357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.raw_retail", "compiled": true, "compiled_code": "\n\nWITH raw_retail AS (\n    SELECT\n        *\n    FROM\n        Retail_Analytics_dbt.ecommerce.raw_retail_data\n)\nSELECT\n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice AS UnitPrice_str,\n    CustomerID,\n    Country\nFROM\n    raw_retail", "relation_name": "Retail_Analytics_dbt.DEV.raw_retail", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.392916Z", "completed_at": "2025-02-21T07:10:42.401405Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.401993Z", "completed_at": "2025-02-21T07:10:42.402003Z"}], "thread_id": "Thread-1", "execution_time": 0.010345697402954102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.retail_cleansed", "compiled": true, "compiled_code": "\n\nWITH filtered_data AS (\n    SELECT\n        InvoiceNo,\n        StockCode,\n        TRIM(UPPER(Description)) AS Description,\n        Quantity,\n        CAST(InvoiceDate AS DATE) AS InvoiceDate,  \n        CASE \n            WHEN UnitPrice_str REGEXP '^[0-9]+(\\.[0-9]+)?$' \n                 AND CAST(UnitPrice_str AS FLOAT) > 0 \n            THEN CAST(UnitPrice_str AS FLOAT)\n            ELSE NULL  \n        END AS UnitPrice,\n        CustomerID,\n        TRIM(UPPER(Country)) AS Country,\n        ROW_NUMBER() OVER (PARTITION BY InvoiceNo ORDER BY InvoiceDate DESC) AS row_num\n    FROM Retail_Analytics_dbt.DEV.raw_retail\n    WHERE \n        InvoiceNo IS NOT NULL \n        AND CustomerID IS NOT NULL \n        AND Description IS NOT NULL \n        AND Description REGEXP '^[A-Za-z0-9 ]+$'\n        AND Quantity > 0\n\n        \n        AND InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.retail_cleansed)  \n        \n)\n\nSELECT \n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice,\n    CustomerID,\n    Country\nFROM filtered_data\nWHERE row_num = 1 \nAND UnitPrice IS NOT NULL", "relation_name": "Retail_Analytics_dbt.DEV.retail_cleansed", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.405401Z", "completed_at": "2025-02-21T07:10:42.409784Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.410366Z", "completed_at": "2025-02-21T07:10:42.410375Z"}], "thread_id": "Thread-1", "execution_time": 0.006238460540771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_rfm", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency,\n        frequency,\n        monetary_value,\n        NTILE(5) OVER (ORDER BY recency DESC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency ASC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value ASC) AS monetary_score\n    FROM rfm_base\n)\n\nSELECT \n    CustomerID,\n    recency,\n    frequency,\n    monetary_value,\n    recency_score,\n    frequency_score,\n    monetary_score,\n    recency_score + frequency_score + monetary_score AS rfm_total_score\nFROM rfm_scores", "relation_name": "Retail_Analytics_dbt.DEV.customer_rfm", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.420709Z", "completed_at": "2025-02-21T07:10:42.425600Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.426191Z", "completed_at": "2025-02-21T07:10:42.426200Z"}], "thread_id": "Thread-1", "execution_time": 0.007073640823364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.facts_sales", "compiled": true, "compiled_code": "\n\nWITH new_sales AS (\n    SELECT \n        InvoiceNo,\n        InvoiceDate,\n        CustomerID,\n        StockCode,\n        Quantity,\n        UnitPrice,\n        Quantity * UnitPrice AS total_amount\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    \n    \n    WHERE InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.facts_sales)\n    \n)\n\nSELECT * FROM new_sales", "relation_name": "Retail_Analytics_dbt.DEV.facts_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.429225Z", "completed_at": "2025-02-21T07:10:42.434205Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.434763Z", "completed_at": "2025-02-21T07:10:42.434771Z"}], "thread_id": "Thread-1", "execution_time": 0.00713658332824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.rfm_segmentation", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    WHERE CustomerID IS NOT NULL\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency, \n        frequency,\n        monetary_value,\n\n        NTILE(5) OVER (ORDER BY recency ASC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency DESC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value DESC) AS monetary_score\n\n    FROM rfm_base\n),\n\nrfm_segmentation AS (\n    SELECT \n        CustomerID,\n        recency,\n        frequency,\n        monetary_value,\n        recency_score,\n        frequency_score,\n        monetary_score,\n        \n        recency_score + frequency_score + monetary_score AS rfm_total_score,\n\n        CASE \n            WHEN recency_score >= 4 AND frequency_score >= 4 AND monetary_score >= 4 THEN 'Best Customers'\n            WHEN recency_score >= 3 AND frequency_score >= 3 AND monetary_score >= 3 THEN 'Loyal Customers'\n            WHEN recency_score >= 3 AND frequency_score <= 2 THEN 'New Customers'\n            WHEN recency_score <= 2 AND frequency_score >= 4 THEN 'At Risk Customers'\n            WHEN recency_score <= 2 AND frequency_score <= 2 THEN 'Lost Customers'\n            ELSE 'Others'\n        END AS customer_segment\n    FROM rfm_scores\n)\n\nSELECT * FROM rfm_segmentation", "relation_name": "Retail_Analytics_dbt.DEV.rfm_segmentation", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.437838Z", "completed_at": "2025-02-21T07:10:42.442036Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.442602Z", "completed_at": "2025-02-21T07:10:42.442609Z"}], "thread_id": "Thread-1", "execution_time": 0.006350040435791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.sales_performance", "compiled": true, "compiled_code": "-- sales performance by month\n\n\nWITH sales AS (\n    SELECT\n        DATE_TRUNC('month', InvoiceDate) AS month,\n        SUM(Quantity * UnitPrice) AS total_sales,\n        COUNT(DISTINCT InvoiceNo) AS total_orders\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY 1\n)\n\nSELECT \n    month,\n    total_sales,\n    total_orders\nFROM sales\nORDER BY month DESC", "relation_name": "Retail_Analytics_dbt.DEV.sales_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.445404Z", "completed_at": "2025-02-21T07:10:42.451257Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.451844Z", "completed_at": "2025-02-21T07:10:42.451852Z"}], "thread_id": "Thread-1", "execution_time": 0.007871389389038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_country___A_Z_.a56523768c", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(country, '^[A-Z ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.454590Z", "completed_at": "2025-02-21T07:10:42.459981Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.460561Z", "completed_at": "2025-02-21T07:10:42.460569Z"}], "thread_id": "Thread-1", "execution_time": 0.007315397262573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_description___A_Za_z0_9_.c511af4a01", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(description, '^[A-Za-z0-9 ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.463348Z", "completed_at": "2025-02-21T07:10:42.474003Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.474567Z", "completed_at": "2025-02-21T07:10:42.474575Z"}], "thread_id": "Thread-1", "execution_time": 0.01259469985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_country.6f766fcede", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.477304Z", "completed_at": "2025-02-21T07:10:42.482246Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.482817Z", "completed_at": "2025-02-21T07:10:42.482825Z"}], "thread_id": "Thread-1", "execution_time": 0.006848335266113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_customerid.ee2eb7401f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.485538Z", "completed_at": "2025-02-21T07:10:42.490607Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.491211Z", "completed_at": "2025-02-21T07:10:42.491219Z"}], "thread_id": "Thread-1", "execution_time": 0.007008790969848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_description.f7892dd595", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect description\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere description is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.493980Z", "completed_at": "2025-02-21T07:10:42.498920Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.499481Z", "completed_at": "2025-02-21T07:10:42.499489Z"}], "thread_id": "Thread-1", "execution_time": 0.006864786148071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoicedate.158713fed2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.502189Z", "completed_at": "2025-02-21T07:10:42.508346Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.508933Z", "completed_at": "2025-02-21T07:10:42.508941Z"}], "thread_id": "Thread-1", "execution_time": 0.008054733276367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoiceno.4de3fe5244", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.511608Z", "completed_at": "2025-02-21T07:10:42.516592Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.517190Z", "completed_at": "2025-02-21T07:10:42.517198Z"}], "thread_id": "Thread-1", "execution_time": 0.006895303726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_quantity.c66a8f7258", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.519938Z", "completed_at": "2025-02-21T07:10:42.524794Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.525378Z", "completed_at": "2025-02-21T07:10:42.525385Z"}], "thread_id": "Thread-1", "execution_time": 0.006808280944824219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_stockcode.a80aad6f0d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.528061Z", "completed_at": "2025-02-21T07:10:42.533064Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.533635Z", "completed_at": "2025-02-21T07:10:42.533643Z"}], "thread_id": "Thread-1", "execution_time": 0.006894588470458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_unitprice.c8e43c7c7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.536422Z", "completed_at": "2025-02-21T07:10:42.541170Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.541734Z", "completed_at": "2025-02-21T07:10:42.541742Z"}], "thread_id": "Thread-1", "execution_time": 0.006679058074951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_quantity.ebbe111451", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.544467Z", "completed_at": "2025-02-21T07:10:42.550453Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.551045Z", "completed_at": "2025-02-21T07:10:42.551053Z"}], "thread_id": "Thread-1", "execution_time": 0.007929563522338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_unitprice.702e3bce82", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.553743Z", "completed_at": "2025-02-21T07:10:42.561047Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.561606Z", "completed_at": "2025-02-21T07:10:42.561614Z"}], "thread_id": "Thread-1", "execution_time": 0.009199142456054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_retail_cleansed_invoiceno.752ff487db", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.564388Z", "completed_at": "2025-02-21T07:10:42.569811Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.570410Z", "completed_at": "2025-02-21T07:10:42.570417Z"}], "thread_id": "Thread-1", "execution_time": 0.00740504264831543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_frequency_score__5__1.2812983e24", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.573137Z", "completed_at": "2025-02-21T07:10:42.578532Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.579123Z", "completed_at": "2025-02-21T07:10:42.579130Z"}], "thread_id": "Thread-1", "execution_time": 0.007277965545654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_monetary_score__5__1.01604b14de", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.581869Z", "completed_at": "2025-02-21T07:10:42.588348Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.588948Z", "completed_at": "2025-02-21T07:10:42.588957Z"}], "thread_id": "Thread-1", "execution_time": 0.008428812026977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_recency_score__5__1.2025cc414f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.591675Z", "completed_at": "2025-02-21T07:10:42.597184Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.597753Z", "completed_at": "2025-02-21T07:10:42.597762Z"}], "thread_id": "Thread-1", "execution_time": 0.007381916046142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_rfm_total_score__15__3.0233537330", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.600500Z", "completed_at": "2025-02-21T07:10:42.605461Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.606040Z", "completed_at": "2025-02-21T07:10:42.606048Z"}], "thread_id": "Thread-1", "execution_time": 0.006894588470458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_customerid.8756c1c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.608712Z", "completed_at": "2025-02-21T07:10:42.613811Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.614406Z", "completed_at": "2025-02-21T07:10:42.614414Z"}], "thread_id": "Thread-1", "execution_time": 0.0070078372955322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency.4f6126998b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.617144Z", "completed_at": "2025-02-21T07:10:42.623034Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.623594Z", "completed_at": "2025-02-21T07:10:42.623602Z"}], "thread_id": "Thread-1", "execution_time": 0.0077970027923583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency_score.ac5407a1e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.626295Z", "completed_at": "2025-02-21T07:10:42.631291Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.631886Z", "completed_at": "2025-02-21T07:10:42.631894Z"}], "thread_id": "Thread-1", "execution_time": 0.006911039352416992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_score.c8961d5f9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.634594Z", "completed_at": "2025-02-21T07:10:42.639680Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.640300Z", "completed_at": "2025-02-21T07:10:42.640308Z"}], "thread_id": "Thread-1", "execution_time": 0.007035732269287109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_value.1afb87803e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.643024Z", "completed_at": "2025-02-21T07:10:42.648327Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.648924Z", "completed_at": "2025-02-21T07:10:42.648932Z"}], "thread_id": "Thread-1", "execution_time": 0.007252216339111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency.ce57eb9baf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.651621Z", "completed_at": "2025-02-21T07:10:42.657761Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.658353Z", "completed_at": "2025-02-21T07:10:42.658361Z"}], "thread_id": "Thread-1", "execution_time": 0.008063077926635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency_score.da6e261a1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.661102Z", "completed_at": "2025-02-21T07:10:42.666008Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.666575Z", "completed_at": "2025-02-21T07:10:42.666583Z"}], "thread_id": "Thread-1", "execution_time": 0.006840944290161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_rfm_total_score.a359721407", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.669349Z", "completed_at": "2025-02-21T07:10:42.674153Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.674719Z", "completed_at": "2025-02-21T07:10:42.674726Z"}], "thread_id": "Thread-1", "execution_time": 0.006714582443237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_frequency.d2fca0de8b", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.677484Z", "completed_at": "2025-02-21T07:10:42.682364Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.682946Z", "completed_at": "2025-02-21T07:10:42.682953Z"}], "thread_id": "Thread-1", "execution_time": 0.006819248199462891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_monetary_value.2a5a7cba3d", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.685609Z", "completed_at": "2025-02-21T07:10:42.691561Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.692151Z", "completed_at": "2025-02-21T07:10:42.692159Z"}], "thread_id": "Thread-1", "execution_time": 0.007848978042602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_recency.3a739403c4", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.694832Z", "completed_at": "2025-02-21T07:10:42.699845Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.700438Z", "completed_at": "2025-02-21T07:10:42.700445Z"}], "thread_id": "Thread-1", "execution_time": 0.006918907165527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_rfm_customerid.038c7b69a4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.703230Z", "completed_at": "2025-02-21T07:10:42.714518Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.715107Z", "completed_at": "2025-02-21T07:10:42.715115Z"}], "thread_id": "Thread-1", "execution_time": 0.013203144073486328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_details", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), ranked_customers AS (\n    SELECT \n        rc.CustomerID,\n        rc.Country, \n        MAX(CAST(rc.InvoiceDate AS TIMESTAMP_NTZ)) AS last_purchase_date,  \n        cs.customer_segment,\n        ROW_NUMBER() OVER (\n            PARTITION BY rc.CustomerID \n            ORDER BY MAX(rc.InvoiceDate) DESC\n        ) AS row_num  \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed rc\n    JOIN __dbt__cte__customer_segmentation cs \n        ON rc.CustomerID = cs.CustomerID\n    WHERE rc.CustomerID IS NOT NULL  \n    GROUP BY rc.CustomerID, rc.Country, cs.customer_segment\n)\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM ranked_customers\nWHERE row_num = 1", "relation_name": "Retail_Analytics_dbt.DEV.customer_details", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.717827Z", "completed_at": "2025-02-21T07:10:42.726195Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.726770Z", "completed_at": "2025-02-21T07:10:42.726777Z"}], "thread_id": "Thread-1", "execution_time": 0.010293722152709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_segmentation_customer_segment__Low_Value__High_Value__Medium_Value.c217f41f8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from __dbt__cte__customer_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.729547Z", "completed_at": "2025-02-21T07:10:42.739338Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.739930Z", "completed_at": "2025-02-21T07:10:42.739939Z"}], "thread_id": "Thread-1", "execution_time": 0.011744976043701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_segmentation_total_spent__0.4ffd3970f1", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_spent >= 0\n)\n as expression\n\n\n    from __dbt__cte__customer_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.742666Z", "completed_at": "2025-02-21T07:10:42.748776Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.749365Z", "completed_at": "2025-02-21T07:10:42.749374Z"}], "thread_id": "Thread-1", "execution_time": 0.008049964904785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customer_segment.43a922a178", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customer_segment\nfrom __dbt__cte__customer_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.752073Z", "completed_at": "2025-02-21T07:10:42.758010Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.758575Z", "completed_at": "2025-02-21T07:10:42.758582Z"}], "thread_id": "Thread-1", "execution_time": 0.007830619812011719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customerid.d076fa21fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customerid\nfrom __dbt__cte__customer_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.761353Z", "completed_at": "2025-02-21T07:10:42.767227Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.767797Z", "completed_at": "2025-02-21T07:10:42.767805Z"}], "thread_id": "Thread-1", "execution_time": 0.00784158706665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_total_spent.b1f375fd04", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select total_spent\nfrom __dbt__cte__customer_segmentation\nwhere total_spent is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.770523Z", "completed_at": "2025-02-21T07:10:42.778587Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.779228Z", "completed_at": "2025-02-21T07:10:42.779242Z"}], "thread_id": "Thread-1", "execution_time": 0.010070323944091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_segmentation_customerid.87af06908f", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__customer_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.782186Z", "completed_at": "2025-02-21T07:10:42.787709Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.788301Z", "completed_at": "2025-02-21T07:10:42.788310Z"}], "thread_id": "Thread-1", "execution_time": 0.007578849792480469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_customerid.5c6a0d807a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.791127Z", "completed_at": "2025-02-21T07:10:42.796358Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.796945Z", "completed_at": "2025-02-21T07:10:42.796954Z"}], "thread_id": "Thread-1", "execution_time": 0.007242679595947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoicedate.9b5164cbca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.799634Z", "completed_at": "2025-02-21T07:10:42.804823Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.805403Z", "completed_at": "2025-02-21T07:10:42.805412Z"}], "thread_id": "Thread-1", "execution_time": 0.00702977180480957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoiceno.814023b4b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.808174Z", "completed_at": "2025-02-21T07:10:42.881786Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.882429Z", "completed_at": "2025-02-21T07:10:42.882441Z"}], "thread_id": "Thread-1", "execution_time": 0.07565116882324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_quantity.5941470935", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.885225Z", "completed_at": "2025-02-21T07:10:42.890423Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.891012Z", "completed_at": "2025-02-21T07:10:42.891021Z"}], "thread_id": "Thread-1", "execution_time": 0.007067203521728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_stockcode.7cd988ce1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.893729Z", "completed_at": "2025-02-21T07:10:42.898923Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.899499Z", "completed_at": "2025-02-21T07:10:42.899507Z"}], "thread_id": "Thread-1", "execution_time": 0.007091522216796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_total_amount.a53a0c6b73", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.902204Z", "completed_at": "2025-02-21T07:10:42.907311Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.907900Z", "completed_at": "2025-02-21T07:10:42.907908Z"}], "thread_id": "Thread-1", "execution_time": 0.006963253021240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_unitprice.5ed09c21d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.910650Z", "completed_at": "2025-02-21T07:10:42.916614Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.917193Z", "completed_at": "2025-02-21T07:10:42.917201Z"}], "thread_id": "Thread-1", "execution_time": 0.007918596267700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_quantity.65c560aef0", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.920043Z", "completed_at": "2025-02-21T07:10:42.924755Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.925338Z", "completed_at": "2025-02-21T07:10:42.925346Z"}], "thread_id": "Thread-1", "execution_time": 0.006797313690185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_unitprice.23717a8a80", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.928032Z", "completed_at": "2025-02-21T07:10:42.933051Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.933626Z", "completed_at": "2025-02-21T07:10:42.933634Z"}], "thread_id": "Thread-1", "execution_time": 0.006922245025634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_facts_sales_invoiceno.72b8d42de3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.936366Z", "completed_at": "2025-02-21T07:10:42.941737Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.942342Z", "completed_at": "2025-02-21T07:10:42.942350Z"}], "thread_id": "Thread-1", "execution_time": 0.007303476333618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_rfm_segmentation_customer_segment__Lost_Customers__Others__New_Customers__At_Risk_Customers__Loyal_Customers__Best_Customers.6591bc65e5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Lost Customers','Others','New Customers','At Risk Customers','Loyal Customers','Best Customers'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.945097Z", "completed_at": "2025-02-21T07:10:42.951678Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.952269Z", "completed_at": "2025-02-21T07:10:42.952278Z"}], "thread_id": "Thread-1", "execution_time": 0.008563995361328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_frequency_score__5__1.83da3ad10d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.954998Z", "completed_at": "2025-02-21T07:10:42.960347Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.960951Z", "completed_at": "2025-02-21T07:10:42.960959Z"}], "thread_id": "Thread-1", "execution_time": 0.0072519779205322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_monetary_score__5__1.9b621f7d6d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.963666Z", "completed_at": "2025-02-21T07:10:42.969067Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.969639Z", "completed_at": "2025-02-21T07:10:42.969647Z"}], "thread_id": "Thread-1", "execution_time": 0.0073070526123046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_recency_score__5__1.5dbb00febf", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.972382Z", "completed_at": "2025-02-21T07:10:42.977752Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.978349Z", "completed_at": "2025-02-21T07:10:42.978356Z"}], "thread_id": "Thread-1", "execution_time": 0.007249116897583008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_rfm_total_score__15__3.c89dd43d37", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.981065Z", "completed_at": "2025-02-21T07:10:42.987221Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.987786Z", "completed_at": "2025-02-21T07:10:42.987795Z"}], "thread_id": "Thread-1", "execution_time": 0.008092403411865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customer_segment.bc3b848ac9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.990491Z", "completed_at": "2025-02-21T07:10:42.995495Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:42.996107Z", "completed_at": "2025-02-21T07:10:42.996116Z"}], "thread_id": "Thread-1", "execution_time": 0.006929636001586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customerid.50d071bf39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:42.998792Z", "completed_at": "2025-02-21T07:10:43.003676Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.004259Z", "completed_at": "2025-02-21T07:10:43.004267Z"}], "thread_id": "Thread-1", "execution_time": 0.0067901611328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency.7a592f92e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.007007Z", "completed_at": "2025-02-21T07:10:43.011932Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.012503Z", "completed_at": "2025-02-21T07:10:43.012511Z"}], "thread_id": "Thread-1", "execution_time": 0.006875514984130859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency_score.cf789cfaf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.015268Z", "completed_at": "2025-02-21T07:10:43.021361Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.021939Z", "completed_at": "2025-02-21T07:10:43.021947Z"}], "thread_id": "Thread-1", "execution_time": 0.008034706115722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_score.3c79b405c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.024598Z", "completed_at": "2025-02-21T07:10:43.029430Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.030013Z", "completed_at": "2025-02-21T07:10:43.030021Z"}], "thread_id": "Thread-1", "execution_time": 0.006671905517578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_value.6f15dbf8c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.032712Z", "completed_at": "2025-02-21T07:10:43.037627Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.038211Z", "completed_at": "2025-02-21T07:10:43.038219Z"}], "thread_id": "Thread-1", "execution_time": 0.00673365592956543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency.da8a73e831", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.041008Z", "completed_at": "2025-02-21T07:10:43.046037Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.046626Z", "completed_at": "2025-02-21T07:10:43.046634Z"}], "thread_id": "Thread-1", "execution_time": 0.007014036178588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency_score.bb262aa125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.049358Z", "completed_at": "2025-02-21T07:10:43.055618Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.056203Z", "completed_at": "2025-02-21T07:10:43.056211Z"}], "thread_id": "Thread-1", "execution_time": 0.008111238479614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_rfm_total_score.fdbc0e1a76", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.058933Z", "completed_at": "2025-02-21T07:10:43.063748Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.064345Z", "completed_at": "2025-02-21T07:10:43.064353Z"}], "thread_id": "Thread-1", "execution_time": 0.006772041320800781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_frequency.7b9a8a5622", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.067102Z", "completed_at": "2025-02-21T07:10:43.071911Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.072479Z", "completed_at": "2025-02-21T07:10:43.072487Z"}], "thread_id": "Thread-1", "execution_time": 0.0067522525787353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_monetary_value.a891bd8f5e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.075179Z", "completed_at": "2025-02-21T07:10:43.079982Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.080543Z", "completed_at": "2025-02-21T07:10:43.080551Z"}], "thread_id": "Thread-1", "execution_time": 0.006634712219238281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_recency.aaf271ec1c", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.083249Z", "completed_at": "2025-02-21T07:10:43.088159Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.088718Z", "completed_at": "2025-02-21T07:10:43.088725Z"}], "thread_id": "Thread-1", "execution_time": 0.0067195892333984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_rfm_segmentation_customerid.74e9ada8ce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.091416Z", "completed_at": "2025-02-21T07:10:43.097771Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.098353Z", "completed_at": "2025-02-21T07:10:43.098361Z"}], "thread_id": "Thread-1", "execution_time": 0.00825810432434082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_month.d21efcf3b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.101082Z", "completed_at": "2025-02-21T07:10:43.105983Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.106547Z", "completed_at": "2025-02-21T07:10:43.106555Z"}], "thread_id": "Thread-1", "execution_time": 0.006819725036621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_orders.28cf895dd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_orders\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.109291Z", "completed_at": "2025-02-21T07:10:43.114168Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.114729Z", "completed_at": "2025-02-21T07:10:43.114736Z"}], "thread_id": "Thread-1", "execution_time": 0.006788730621337891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_sales.62238b2d9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_sales is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.117397Z", "completed_at": "2025-02-21T07:10:43.122285Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.122848Z", "completed_at": "2025-02-21T07:10:43.122855Z"}], "thread_id": "Thread-1", "execution_time": 0.006715297698974609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_orders.bcc49b526e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_orders <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.125558Z", "completed_at": "2025-02-21T07:10:43.131445Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.132029Z", "completed_at": "2025-02-21T07:10:43.132038Z"}], "thread_id": "Thread-1", "execution_time": 0.0077893733978271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_sales.277d5be8a8", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_sales <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.134700Z", "completed_at": "2025-02-21T07:10:43.139676Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.140273Z", "completed_at": "2025-02-21T07:10:43.140280Z"}], "thread_id": "Thread-1", "execution_time": 0.006880521774291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_sales_performance_month.8f24859e00", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    month as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is not null\ngroup by month\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.143002Z", "completed_at": "2025-02-21T07:10:43.146609Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.147312Z", "completed_at": "2025-02-21T07:10:43.147320Z"}], "thread_id": "Thread-1", "execution_time": 0.005660057067871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_assignment_1.customer_data_snapshot", "compiled": true, "compiled_code": "\n\n\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM Retail_Analytics_dbt.DEV.customer_details\n", "relation_name": "Retail_Analytics_dbt.DEV.customer_data_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.150145Z", "completed_at": "2025-02-21T07:10:43.155303Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.155889Z", "completed_at": "2025-02-21T07:10:43.155897Z"}], "thread_id": "Thread-1", "execution_time": 0.007115840911865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_details_customer_segment__Low_Value__High_Value__Medium_Value.4531c05819", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.customer_details\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.158607Z", "completed_at": "2025-02-21T07:10:43.164626Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.165209Z", "completed_at": "2025-02-21T07:10:43.165216Z"}], "thread_id": "Thread-1", "execution_time": 0.007950305938720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_country.e482842f53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.167902Z", "completed_at": "2025-02-21T07:10:43.172792Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.173417Z", "completed_at": "2025-02-21T07:10:43.173428Z"}], "thread_id": "Thread-1", "execution_time": 0.006838083267211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customer_segment.04ce2e4c5a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.177095Z", "completed_at": "2025-02-21T07:10:43.182067Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.182631Z", "completed_at": "2025-02-21T07:10:43.182640Z"}], "thread_id": "Thread-1", "execution_time": 0.007170200347900391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customerid.06b05eda46", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.185284Z", "completed_at": "2025-02-21T07:10:43.190242Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.190797Z", "completed_at": "2025-02-21T07:10:43.190805Z"}], "thread_id": "Thread-1", "execution_time": 0.0067746639251708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_last_purchase_date.e3942b63a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_purchase_date\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere last_purchase_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:10:43.193420Z", "completed_at": "2025-02-21T07:10:43.199393Z"}, {"name": "execute", "started_at": "2025-02-21T07:10:43.199973Z", "completed_at": "2025-02-21T07:10:43.199981Z"}], "thread_id": "Thread-1", "execution_time": 0.0077860355377197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_details_customerid.77f44ca40a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.8042402267456055, "args": {"indirect_selection": "eager", "printer_width": 80, "empty_catalog": false, "require_yaml_configuration_for_mf_time_spines": false, "log_format_file": "debug", "skip_nodes_if_on_run_start_fails": false, "show_resource_report": false, "select": [], "version_check": true, "log_file_max_bytes": 10485760, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "/home/runner/work/dbt_assignment_1/dbt_assignment_1", "source_freshness_run_project_hooks": false, "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true, "log_path": "/home/runner/work/dbt_assignment_1/dbt_assignment_1/logs", "use_colors": true, "vars": {}, "log_level_file": "debug", "write_json": true, "compile": true, "strict_mode": false, "state_modified_compare_vars": false, "send_anonymous_usage_stats": true, "print": true, "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "quiet": false, "introspect": true, "log_format": "default", "invocation_command": "dbt docs generate", "macro_debugging": false, "require_resource_names_without_spaces": false, "cache_selected_only": false, "defer": false, "partial_parse": true, "use_colors_file": true, "require_nested_cumulative_type_params": false, "which": "generate", "favor_state": false, "static": false, "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "partial_parse_file_diff": true, "profiles_dir": "/home/runner/.dbt"}}