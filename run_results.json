{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-02-21T07:49:02.618934Z", "invocation_id": "9b2c01c7-b8dc-489e-90a5-c9cd92bc51f5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.350171Z", "completed_at": "2025-02-21T07:49:01.360546Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.361155Z", "completed_at": "2025-02-21T07:49:01.361171Z"}], "thread_id": "Thread-1", "execution_time": 0.012284994125366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.raw_retail", "compiled": true, "compiled_code": "\n\nWITH raw_retail AS (\n    SELECT\n        *\n    FROM\n        Retail_Analytics_dbt.ecommerce.raw_retail_data\n)\nSELECT\n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice AS UnitPrice_str,\n    CustomerID,\n    Country\nFROM\n    raw_retail", "relation_name": "Retail_Analytics_dbt.DEV.raw_retail", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.364144Z", "completed_at": "2025-02-21T07:49:01.371891Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.372462Z", "completed_at": "2025-02-21T07:49:01.372470Z"}], "thread_id": "Thread-1", "execution_time": 0.009568929672241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.retail_cleansed", "compiled": true, "compiled_code": "\n\nWITH filtered_data AS (\n    SELECT\n        InvoiceNo,\n        StockCode,\n        TRIM(UPPER(Description)) AS Description,\n        Quantity,\n        CAST(InvoiceDate AS DATE) AS InvoiceDate,  \n        CASE \n            WHEN UnitPrice_str REGEXP '^[0-9]+(\\.[0-9]+)?$' \n                 AND CAST(UnitPrice_str AS FLOAT) > 0 \n            THEN CAST(UnitPrice_str AS FLOAT)\n            ELSE NULL  \n        END AS UnitPrice,\n        CustomerID,\n        TRIM(UPPER(Country)) AS Country,\n        ROW_NUMBER() OVER (PARTITION BY InvoiceNo ORDER BY InvoiceDate DESC) AS row_num\n    FROM Retail_Analytics_dbt.DEV.raw_retail\n    WHERE \n        InvoiceNo IS NOT NULL \n        AND CustomerID IS NOT NULL \n        AND Description IS NOT NULL \n        AND Description REGEXP '^[A-Za-z0-9 ]+$'\n        AND Quantity > 0\n\n        \n        AND InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.retail_cleansed)  \n        \n)\n\nSELECT \n    InvoiceNo,\n    StockCode,\n    Description,\n    Quantity,\n    InvoiceDate,\n    UnitPrice,\n    CustomerID,\n    Country\nFROM filtered_data\nWHERE row_num = 1 \nAND UnitPrice IS NOT NULL", "relation_name": "Retail_Analytics_dbt.DEV.retail_cleansed", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.375616Z", "completed_at": "2025-02-21T07:49:01.379710Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.380290Z", "completed_at": "2025-02-21T07:49:01.380297Z"}], "thread_id": "Thread-1", "execution_time": 0.005928516387939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_rfm", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency,\n        frequency,\n        monetary_value,\n        NTILE(5) OVER (ORDER BY recency DESC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency ASC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value ASC) AS monetary_score\n    FROM rfm_base\n)\n\nSELECT \n    CustomerID,\n    recency,\n    frequency,\n    monetary_value,\n    recency_score,\n    frequency_score,\n    monetary_score,\n    recency_score + frequency_score + monetary_score AS rfm_total_score\nFROM rfm_scores", "relation_name": "Retail_Analytics_dbt.DEV.customer_rfm", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.390261Z", "completed_at": "2025-02-21T07:49:01.395099Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.395651Z", "completed_at": "2025-02-21T07:49:01.395659Z"}], "thread_id": "Thread-1", "execution_time": 0.006833076477050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.facts_sales", "compiled": true, "compiled_code": "\n\nWITH new_sales AS (\n    SELECT \n        InvoiceNo,\n        InvoiceDate,\n        CustomerID,\n        StockCode,\n        Quantity,\n        UnitPrice,\n        Quantity * UnitPrice AS total_amount\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    \n    \n    WHERE InvoiceDate > (SELECT MAX(InvoiceDate) FROM Retail_Analytics_dbt.DEV.facts_sales)\n    \n)\n\nSELECT * FROM new_sales", "relation_name": "Retail_Analytics_dbt.DEV.facts_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.398369Z", "completed_at": "2025-02-21T07:49:01.403542Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.404147Z", "completed_at": "2025-02-21T07:49:01.404155Z"}], "thread_id": "Thread-1", "execution_time": 0.0070650577545166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.rfm_segmentation", "compiled": true, "compiled_code": "\n\nWITH rfm_base AS (\n    SELECT \n        CustomerID,\n        MAX(InvoiceDate) AS last_purchase_date,\n        COUNT(DISTINCT InvoiceNo) AS frequency,\n        SUM(Quantity * UnitPrice) AS monetary_value \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    WHERE CustomerID IS NOT NULL\n    GROUP BY CustomerID\n),\n\nrfm_scores AS (\n    SELECT \n        CustomerID,\n        DATEDIFF(day, last_purchase_date, CURRENT_DATE) AS recency, \n        frequency,\n        monetary_value,\n\n        NTILE(5) OVER (ORDER BY recency ASC) AS recency_score,\n        NTILE(5) OVER (ORDER BY frequency DESC) AS frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value DESC) AS monetary_score\n\n    FROM rfm_base\n),\n\nrfm_segmentation AS (\n    SELECT \n        CustomerID,\n        recency,\n        frequency,\n        monetary_value,\n        recency_score,\n        frequency_score,\n        monetary_score,\n        \n        recency_score + frequency_score + monetary_score AS rfm_total_score,\n\n        CASE \n            WHEN recency_score >= 4 AND frequency_score >= 4 AND monetary_score >= 4 THEN 'Best Customers'\n            WHEN recency_score >= 3 AND frequency_score >= 3 AND monetary_score >= 3 THEN 'Loyal Customers'\n            WHEN recency_score >= 3 AND frequency_score <= 2 THEN 'New Customers'\n            WHEN recency_score <= 2 AND frequency_score >= 4 THEN 'At Risk Customers'\n            WHEN recency_score <= 2 AND frequency_score <= 2 THEN 'Lost Customers'\n            ELSE 'Others'\n        END AS customer_segment\n    FROM rfm_scores\n)\n\nSELECT * FROM rfm_segmentation", "relation_name": "Retail_Analytics_dbt.DEV.rfm_segmentation", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.407101Z", "completed_at": "2025-02-21T07:49:01.411092Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.411649Z", "completed_at": "2025-02-21T07:49:01.411656Z"}], "thread_id": "Thread-1", "execution_time": 0.006186485290527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.sales_performance", "compiled": true, "compiled_code": "-- sales performance by month\n\n\nWITH sales AS (\n    SELECT\n        DATE_TRUNC('month', InvoiceDate) AS month,\n        SUM(Quantity * UnitPrice) AS total_sales,\n        COUNT(DISTINCT InvoiceNo) AS total_orders\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY 1\n)\n\nSELECT \n    month,\n    total_sales,\n    total_orders\nFROM sales\nORDER BY month DESC", "relation_name": "Retail_Analytics_dbt.DEV.sales_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.414514Z", "completed_at": "2025-02-21T07:49:01.419971Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.420544Z", "completed_at": "2025-02-21T07:49:01.420551Z"}], "thread_id": "Thread-1", "execution_time": 0.007312297821044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_country___A_Z_.a56523768c", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(country, '^[A-Z ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.423213Z", "completed_at": "2025-02-21T07:49:01.428461Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.429047Z", "completed_at": "2025-02-21T07:49:01.429054Z"}], "thread_id": "Thread-1", "execution_time": 0.007111072540283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_match_regex_retail_cleansed_description___A_Za_z0_9_.c511af4a01", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(description, '^[A-Za-z0-9 ]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.retail_cleansed\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.431654Z", "completed_at": "2025-02-21T07:49:01.442029Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.442585Z", "completed_at": "2025-02-21T07:49:01.442593Z"}], "thread_id": "Thread-1", "execution_time": 0.012180328369140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_country.6f766fcede", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.445232Z", "completed_at": "2025-02-21T07:49:01.450050Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.450606Z", "completed_at": "2025-02-21T07:49:01.450613Z"}], "thread_id": "Thread-1", "execution_time": 0.0066869258880615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_customerid.ee2eb7401f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.453258Z", "completed_at": "2025-02-21T07:49:01.458081Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.458635Z", "completed_at": "2025-02-21T07:49:01.458643Z"}], "thread_id": "Thread-1", "execution_time": 0.006693601608276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_description.f7892dd595", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect description\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere description is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.461391Z", "completed_at": "2025-02-21T07:49:01.466266Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.466820Z", "completed_at": "2025-02-21T07:49:01.466827Z"}], "thread_id": "Thread-1", "execution_time": 0.006769895553588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoicedate.158713fed2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.469438Z", "completed_at": "2025-02-21T07:49:01.475191Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.475739Z", "completed_at": "2025-02-21T07:49:01.475747Z"}], "thread_id": "Thread-1", "execution_time": 0.007620811462402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_invoiceno.4de3fe5244", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.478371Z", "completed_at": "2025-02-21T07:49:01.483271Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.483827Z", "completed_at": "2025-02-21T07:49:01.483850Z"}], "thread_id": "Thread-1", "execution_time": 0.006789684295654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_quantity.c66a8f7258", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.486469Z", "completed_at": "2025-02-21T07:49:01.491263Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.491823Z", "completed_at": "2025-02-21T07:49:01.491847Z"}], "thread_id": "Thread-1", "execution_time": 0.006676673889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_stockcode.a80aad6f0d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.494455Z", "completed_at": "2025-02-21T07:49:01.499274Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.499850Z", "completed_at": "2025-02-21T07:49:01.499857Z"}], "thread_id": "Thread-1", "execution_time": 0.0066547393798828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_retail_cleansed_unitprice.c8e43c7c7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.502517Z", "completed_at": "2025-02-21T07:49:01.507209Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.507768Z", "completed_at": "2025-02-21T07:49:01.507775Z"}], "thread_id": "Thread-1", "execution_time": 0.006533145904541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_quantity.ebbe111451", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.510413Z", "completed_at": "2025-02-21T07:49:01.516141Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.516702Z", "completed_at": "2025-02-21T07:49:01.516709Z"}], "thread_id": "Thread-1", "execution_time": 0.007599592208862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_retail_cleansed_unitprice.702e3bce82", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.retail_cleansed\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.519381Z", "completed_at": "2025-02-21T07:49:01.526559Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.527181Z", "completed_at": "2025-02-21T07:49:01.527189Z"}], "thread_id": "Thread-1", "execution_time": 0.009064435958862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_retail_cleansed_invoiceno.752ff487db", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.retail_cleansed\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.529865Z", "completed_at": "2025-02-21T07:49:01.535142Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.535723Z", "completed_at": "2025-02-21T07:49:01.535730Z"}], "thread_id": "Thread-1", "execution_time": 0.007210969924926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_frequency_score__5__1.2812983e24", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.538404Z", "completed_at": "2025-02-21T07:49:01.543636Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.544226Z", "completed_at": "2025-02-21T07:49:01.544233Z"}], "thread_id": "Thread-1", "execution_time": 0.0071370601654052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_monetary_score__5__1.01604b14de", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.546903Z", "completed_at": "2025-02-21T07:49:01.553031Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.553605Z", "completed_at": "2025-02-21T07:49:01.553612Z"}], "thread_id": "Thread-1", "execution_time": 0.008053779602050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_recency_score__5__1.2025cc414f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.556270Z", "completed_at": "2025-02-21T07:49:01.561554Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.562144Z", "completed_at": "2025-02-21T07:49:01.562151Z"}], "thread_id": "Thread-1", "execution_time": 0.007197141647338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_rfm_rfm_total_score__15__3.0233537330", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.customer_rfm\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.564803Z", "completed_at": "2025-02-21T07:49:01.569617Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.570199Z", "completed_at": "2025-02-21T07:49:01.570207Z"}], "thread_id": "Thread-1", "execution_time": 0.006728649139404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_customerid.8756c1c3df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.572817Z", "completed_at": "2025-02-21T07:49:01.577732Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.578322Z", "completed_at": "2025-02-21T07:49:01.578330Z"}], "thread_id": "Thread-1", "execution_time": 0.006809234619140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency.4f6126998b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.580985Z", "completed_at": "2025-02-21T07:49:01.586658Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.587246Z", "completed_at": "2025-02-21T07:49:01.587253Z"}], "thread_id": "Thread-1", "execution_time": 0.007609367370605469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_frequency_score.ac5407a1e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.589915Z", "completed_at": "2025-02-21T07:49:01.594738Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.595317Z", "completed_at": "2025-02-21T07:49:01.595324Z"}], "thread_id": "Thread-1", "execution_time": 0.006738424301147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_score.c8961d5f9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.598024Z", "completed_at": "2025-02-21T07:49:01.602827Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.603415Z", "completed_at": "2025-02-21T07:49:01.603423Z"}], "thread_id": "Thread-1", "execution_time": 0.006659507751464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_monetary_value.1afb87803e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.606097Z", "completed_at": "2025-02-21T07:49:01.611021Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.611575Z", "completed_at": "2025-02-21T07:49:01.611582Z"}], "thread_id": "Thread-1", "execution_time": 0.006844758987426758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency.ce57eb9baf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.614214Z", "completed_at": "2025-02-21T07:49:01.619900Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.620463Z", "completed_at": "2025-02-21T07:49:01.620471Z"}], "thread_id": "Thread-1", "execution_time": 0.007501125335693359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_recency_score.da6e261a1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.623124Z", "completed_at": "2025-02-21T07:49:01.627935Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.628496Z", "completed_at": "2025-02-21T07:49:01.628503Z"}], "thread_id": "Thread-1", "execution_time": 0.006640195846557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_rfm_rfm_total_score.a359721407", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.631146Z", "completed_at": "2025-02-21T07:49:01.635751Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.636334Z", "completed_at": "2025-02-21T07:49:01.636341Z"}], "thread_id": "Thread-1", "execution_time": 0.006440639495849609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_frequency.d2fca0de8b", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.638976Z", "completed_at": "2025-02-21T07:49:01.643739Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.644331Z", "completed_at": "2025-02-21T07:49:01.644338Z"}], "thread_id": "Thread-1", "execution_time": 0.006690263748168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_monetary_value.2a5a7cba3d", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.646979Z", "completed_at": "2025-02-21T07:49:01.652544Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.653126Z", "completed_at": "2025-02-21T07:49:01.653133Z"}], "thread_id": "Thread-1", "execution_time": 0.007487773895263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_customer_rfm_recency.3a739403c4", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.customer_rfm\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.655744Z", "completed_at": "2025-02-21T07:49:01.660595Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.661178Z", "completed_at": "2025-02-21T07:49:01.661185Z"}], "thread_id": "Thread-1", "execution_time": 0.006734371185302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_rfm_customerid.038c7b69a4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_rfm\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.663795Z", "completed_at": "2025-02-21T07:49:01.674823Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.675402Z", "completed_at": "2025-02-21T07:49:01.675410Z"}], "thread_id": "Thread-1", "execution_time": 0.012925863265991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_assignment_1.customer_details", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), ranked_customers AS (\n    SELECT \n        rc.CustomerID,\n        rc.Country, \n        MAX(CAST(rc.InvoiceDate AS TIMESTAMP_NTZ)) AS last_purchase_date,  \n        cs.customer_segment,\n        ROW_NUMBER() OVER (\n            PARTITION BY rc.CustomerID \n            ORDER BY MAX(rc.InvoiceDate) DESC\n        ) AS row_num  \n    FROM Retail_Analytics_dbt.DEV.retail_cleansed rc\n    JOIN __dbt__cte__customer_segmentation cs \n        ON rc.CustomerID = cs.CustomerID\n    WHERE rc.CustomerID IS NOT NULL  \n    GROUP BY rc.CustomerID, rc.Country, cs.customer_segment\n)\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM ranked_customers\nWHERE row_num = 1", "relation_name": "Retail_Analytics_dbt.DEV.customer_details", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.678310Z", "completed_at": "2025-02-21T07:49:01.686247Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.686815Z", "completed_at": "2025-02-21T07:49:01.686822Z"}], "thread_id": "Thread-1", "execution_time": 0.010107278823852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_segmentation_customer_segment__Low_Value__High_Value__Medium_Value.c217f41f8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from __dbt__cte__customer_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.689481Z", "completed_at": "2025-02-21T07:49:01.699072Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.699644Z", "completed_at": "2025-02-21T07:49:01.699652Z"}], "thread_id": "Thread-1", "execution_time": 0.011429548263549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_customer_segmentation_total_spent__0.4ffd3970f1", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with  __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n), grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_spent >= 0\n)\n as expression\n\n\n    from __dbt__cte__customer_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.702347Z", "completed_at": "2025-02-21T07:49:01.708151Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.708710Z", "completed_at": "2025-02-21T07:49:01.708717Z"}], "thread_id": "Thread-1", "execution_time": 0.007643222808837891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customer_segment.43a922a178", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customer_segment\nfrom __dbt__cte__customer_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.711356Z", "completed_at": "2025-02-21T07:49:01.717041Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.717595Z", "completed_at": "2025-02-21T07:49:01.717602Z"}], "thread_id": "Thread-1", "execution_time": 0.0074939727783203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_customerid.d076fa21fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select customerid\nfrom __dbt__cte__customer_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.720255Z", "completed_at": "2025-02-21T07:49:01.726091Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.726645Z", "completed_at": "2025-02-21T07:49:01.726653Z"}], "thread_id": "Thread-1", "execution_time": 0.007666826248168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_segmentation_total_spent.b1f375fd04", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select total_spent\nfrom __dbt__cte__customer_segmentation\nwhere total_spent is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.729265Z", "completed_at": "2025-02-21T07:49:01.736742Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.737320Z", "completed_at": "2025-02-21T07:49:01.737328Z"}], "thread_id": "Thread-1", "execution_time": 0.00930333137512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_segmentation_customerid.87af06908f", "compiled": true, "compiled_code": "\n    \n    \n\nwith __dbt__cte__customer_segmentation as (\n\n\nWITH customer_spend AS (\n    SELECT\n        CustomerID,\n        SUM(Quantity * UnitPrice) AS total_spent\n    FROM Retail_Analytics_dbt.DEV.retail_cleansed\n    GROUP BY CustomerID\n)\n\nSELECT \n    CustomerID,\n    total_spent,\n    CASE\n        WHEN total_spent > 30000 THEN 'High-Value'\n        WHEN total_spent BETWEEN 10000 AND 30000 THEN 'Medium-Value'\n        ELSE 'Low-Value'\n    END AS customer_segment\nFROM customer_spend\n) select\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom __dbt__cte__customer_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.739956Z", "completed_at": "2025-02-21T07:49:01.744769Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.745349Z", "completed_at": "2025-02-21T07:49:01.745356Z"}], "thread_id": "Thread-1", "execution_time": 0.006725788116455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_customerid.5c6a0d807a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.747994Z", "completed_at": "2025-02-21T07:49:01.752810Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.753394Z", "completed_at": "2025-02-21T07:49:01.753402Z"}], "thread_id": "Thread-1", "execution_time": 0.006729602813720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoicedate.9b5164cbca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoicedate\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoicedate is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.755990Z", "completed_at": "2025-02-21T07:49:01.760930Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.761492Z", "completed_at": "2025-02-21T07:49:01.761500Z"}], "thread_id": "Thread-1", "execution_time": 0.006743431091308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_invoiceno.814023b4b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect invoiceno\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.764135Z", "completed_at": "2025-02-21T07:49:01.831109Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.831687Z", "completed_at": "2025-02-21T07:49:01.831697Z"}], "thread_id": "Thread-1", "execution_time": 0.06887125968933105, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_quantity.5941470935", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.834396Z", "completed_at": "2025-02-21T07:49:01.839280Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.839829Z", "completed_at": "2025-02-21T07:49:01.839853Z"}], "thread_id": "Thread-1", "execution_time": 0.006803035736083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_stockcode.7cd988ce1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stockcode\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere stockcode is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.842438Z", "completed_at": "2025-02-21T07:49:01.847310Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.847893Z", "completed_at": "2025-02-21T07:49:01.847900Z"}], "thread_id": "Thread-1", "execution_time": 0.006685972213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_total_amount.a53a0c6b73", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_amount\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere total_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.850512Z", "completed_at": "2025-02-21T07:49:01.855327Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.855903Z", "completed_at": "2025-02-21T07:49:01.855911Z"}], "thread_id": "Thread-1", "execution_time": 0.0066640377044677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_facts_sales_unitprice.5ed09c21d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unitprice\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere unitprice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.858529Z", "completed_at": "2025-02-21T07:49:01.864202Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.864761Z", "completed_at": "2025-02-21T07:49:01.864769Z"}], "thread_id": "Thread-1", "execution_time": 0.007516145706176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_quantity.65c560aef0", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE quantity <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.867516Z", "completed_at": "2025-02-21T07:49:01.872092Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.872647Z", "completed_at": "2025-02-21T07:49:01.872654Z"}], "thread_id": "Thread-1", "execution_time": 0.006560325622558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_facts_sales_unitprice.23717a8a80", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.facts_sales\nWHERE unitprice <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.875306Z", "completed_at": "2025-02-21T07:49:01.880111Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.880689Z", "completed_at": "2025-02-21T07:49:01.880697Z"}], "thread_id": "Thread-1", "execution_time": 0.006728410720825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_facts_sales_invoiceno.72b8d42de3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    invoiceno as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.facts_sales\nwhere invoiceno is not null\ngroup by invoiceno\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.883423Z", "completed_at": "2025-02-21T07:49:01.888482Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.889077Z", "completed_at": "2025-02-21T07:49:01.889084Z"}], "thread_id": "Thread-1", "execution_time": 0.006922245025634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_rfm_segmentation_customer_segment__Lost_Customers__Others__New_Customers__At_Risk_Customers__Loyal_Customers__Best_Customers.6591bc65e5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Lost Customers','Others','New Customers','At Risk Customers','Loyal Customers','Best Customers'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.891729Z", "completed_at": "2025-02-21T07:49:01.898135Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.898701Z", "completed_at": "2025-02-21T07:49:01.898708Z"}], "thread_id": "Thread-1", "execution_time": 0.00824284553527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_frequency_score__5__1.83da3ad10d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and frequency_score >= 1 and frequency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.901391Z", "completed_at": "2025-02-21T07:49:01.906602Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.907188Z", "completed_at": "2025-02-21T07:49:01.907196Z"}], "thread_id": "Thread-1", "execution_time": 0.007135152816772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_monetary_score__5__1.9b621f7d6d", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and monetary_score >= 1 and monetary_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.909826Z", "completed_at": "2025-02-21T07:49:01.915097Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.915660Z", "completed_at": "2025-02-21T07:49:01.915668Z"}], "thread_id": "Thread-1", "execution_time": 0.007147789001464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_recency_score__5__1.5dbb00febf", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and recency_score >= 1 and recency_score <= 5\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.918331Z", "completed_at": "2025-02-21T07:49:01.923544Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.924130Z", "completed_at": "2025-02-21T07:49:01.924137Z"}], "thread_id": "Thread-1", "execution_time": 0.007132530212402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.dbt_expectations_expect_column_values_to_be_between_rfm_segmentation_rfm_total_score__15__3.c89dd43d37", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and rfm_total_score >= 3 and rfm_total_score <= 15\n)\n as expression\n\n\n    from Retail_Analytics_dbt.DEV.rfm_segmentation\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.926778Z", "completed_at": "2025-02-21T07:49:01.932568Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.933150Z", "completed_at": "2025-02-21T07:49:01.933158Z"}], "thread_id": "Thread-1", "execution_time": 0.007633209228515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customer_segment.bc3b848ac9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.935754Z", "completed_at": "2025-02-21T07:49:01.940556Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.941129Z", "completed_at": "2025-02-21T07:49:01.941137Z"}], "thread_id": "Thread-1", "execution_time": 0.0066149234771728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_customerid.50d071bf39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.943719Z", "completed_at": "2025-02-21T07:49:01.948506Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.949082Z", "completed_at": "2025-02-21T07:49:01.949089Z"}], "thread_id": "Thread-1", "execution_time": 0.006602048873901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency.7a592f92e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.951777Z", "completed_at": "2025-02-21T07:49:01.956605Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.957187Z", "completed_at": "2025-02-21T07:49:01.957195Z"}], "thread_id": "Thread-1", "execution_time": 0.0067250728607177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_frequency_score.cf789cfaf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect frequency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere frequency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.959798Z", "completed_at": "2025-02-21T07:49:01.965705Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.966285Z", "completed_at": "2025-02-21T07:49:01.966293Z"}], "thread_id": "Thread-1", "execution_time": 0.007729530334472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_score.3c79b405c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.968946Z", "completed_at": "2025-02-21T07:49:01.973777Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.974360Z", "completed_at": "2025-02-21T07:49:01.974367Z"}], "thread_id": "Thread-1", "execution_time": 0.006763458251953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_monetary_value.6f15dbf8c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect monetary_value\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere monetary_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.977009Z", "completed_at": "2025-02-21T07:49:01.981802Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.982382Z", "completed_at": "2025-02-21T07:49:01.982389Z"}], "thread_id": "Thread-1", "execution_time": 0.006617307662963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency.da8a73e831", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.985048Z", "completed_at": "2025-02-21T07:49:01.989861Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.990422Z", "completed_at": "2025-02-21T07:49:01.990429Z"}], "thread_id": "Thread-1", "execution_time": 0.006720542907714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_recency_score.bb262aa125", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect recency_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere recency_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:01.993076Z", "completed_at": "2025-02-21T07:49:01.999058Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:01.999611Z", "completed_at": "2025-02-21T07:49:01.999618Z"}], "thread_id": "Thread-1", "execution_time": 0.007844686508178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_rfm_segmentation_rfm_total_score.fdbc0e1a76", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rfm_total_score\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere rfm_total_score is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.002269Z", "completed_at": "2025-02-21T07:49:02.006975Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.007551Z", "completed_at": "2025-02-21T07:49:02.007558Z"}], "thread_id": "Thread-1", "execution_time": 0.006585121154785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_frequency.7b9a8a5622", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE frequency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.010231Z", "completed_at": "2025-02-21T07:49:02.015125Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.015687Z", "completed_at": "2025-02-21T07:49:02.015694Z"}], "thread_id": "Thread-1", "execution_time": 0.006772518157958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_monetary_value.a891bd8f5e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE monetary_value <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.018339Z", "completed_at": "2025-02-21T07:49:02.023003Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.023571Z", "completed_at": "2025-02-21T07:49:02.023578Z"}], "thread_id": "Thread-1", "execution_time": 0.006471157073974609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_rfm_segmentation_recency.aaf271ec1c", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.rfm_segmentation\nWHERE recency <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.026176Z", "completed_at": "2025-02-21T07:49:02.030998Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.031564Z", "completed_at": "2025-02-21T07:49:02.031571Z"}], "thread_id": "Thread-1", "execution_time": 0.006613731384277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_rfm_segmentation_customerid.74e9ada8ce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.rfm_segmentation\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.034163Z", "completed_at": "2025-02-21T07:49:02.040278Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.040853Z", "completed_at": "2025-02-21T07:49:02.040860Z"}], "thread_id": "Thread-1", "execution_time": 0.007920503616333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_month.d21efcf3b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.043504Z", "completed_at": "2025-02-21T07:49:02.048331Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.048916Z", "completed_at": "2025-02-21T07:49:02.048924Z"}], "thread_id": "Thread-1", "execution_time": 0.006681919097900391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_orders.28cf895dd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_orders\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.051567Z", "completed_at": "2025-02-21T07:49:02.056402Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.056986Z", "completed_at": "2025-02-21T07:49:02.056993Z"}], "thread_id": "Thread-1", "execution_time": 0.006682395935058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_sales_performance_total_sales.62238b2d9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere total_sales is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.059621Z", "completed_at": "2025-02-21T07:49:02.064436Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.065019Z", "completed_at": "2025-02-21T07:49:02.065026Z"}], "thread_id": "Thread-1", "execution_time": 0.006714344024658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_orders.bcc49b526e", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_orders <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.067614Z", "completed_at": "2025-02-21T07:49:02.073302Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.073876Z", "completed_at": "2025-02-21T07:49:02.073883Z"}], "thread_id": "Thread-1", "execution_time": 0.007546901702880859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.positive_values_sales_performance_total_sales.277d5be8a8", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM Retail_Analytics_dbt.DEV.sales_performance\nWHERE total_sales <= 0\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.076496Z", "completed_at": "2025-02-21T07:49:02.081308Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.081899Z", "completed_at": "2025-02-21T07:49:02.081906Z"}], "thread_id": "Thread-1", "execution_time": 0.006704092025756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_sales_performance_month.8f24859e00", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    month as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.sales_performance\nwhere month is not null\ngroup by month\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.084561Z", "completed_at": "2025-02-21T07:49:02.088111Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.088689Z", "completed_at": "2025-02-21T07:49:02.088697Z"}], "thread_id": "Thread-1", "execution_time": 0.005412578582763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_assignment_1.customer_data_snapshot", "compiled": true, "compiled_code": "\n\n\n\nSELECT \n    CustomerID,\n    Country,\n    last_purchase_date,\n    customer_segment\nFROM Retail_Analytics_dbt.DEV.customer_details\n", "relation_name": "Retail_Analytics_dbt.DEV.customer_data_snapshot", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.091409Z", "completed_at": "2025-02-21T07:49:02.096503Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.097171Z", "completed_at": "2025-02-21T07:49:02.097179Z"}], "thread_id": "Thread-1", "execution_time": 0.007139682769775391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.accepted_values_customer_details_customer_segment__Low_Value__High_Value__Medium_Value.4531c05819", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from Retail_Analytics_dbt.DEV.customer_details\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Low-Value','High-Value','Medium-Value'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.100028Z", "completed_at": "2025-02-21T07:49:02.106048Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.106619Z", "completed_at": "2025-02-21T07:49:02.106626Z"}], "thread_id": "Thread-1", "execution_time": 0.007986068725585938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_country.e482842f53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere country is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.109333Z", "completed_at": "2025-02-21T07:49:02.114211Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.114771Z", "completed_at": "2025-02-21T07:49:02.114778Z"}], "thread_id": "Thread-1", "execution_time": 0.0067327022552490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customer_segment.04ce2e4c5a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customer_segment is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.117424Z", "completed_at": "2025-02-21T07:49:02.122211Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.122769Z", "completed_at": "2025-02-21T07:49:02.122777Z"}], "thread_id": "Thread-1", "execution_time": 0.00661778450012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_customerid.06b05eda46", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.125364Z", "completed_at": "2025-02-21T07:49:02.130161Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.130712Z", "completed_at": "2025-02-21T07:49:02.130720Z"}], "thread_id": "Thread-1", "execution_time": 0.006593227386474609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.not_null_customer_details_last_purchase_date.e3942b63a8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_purchase_date\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere last_purchase_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-21T07:49:02.133294Z", "completed_at": "2025-02-21T07:49:02.138984Z"}, {"name": "execute", "started_at": "2025-02-21T07:49:02.139537Z", "completed_at": "2025-02-21T07:49:02.139545Z"}], "thread_id": "Thread-1", "execution_time": 0.007481575012207031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_assignment_1.unique_customer_details_customerid.77f44ca40a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customerid as unique_field,\n    count(*) as n_records\n\nfrom Retail_Analytics_dbt.DEV.customer_details\nwhere customerid is not null\ngroup by customerid\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.7501914501190186, "args": {"partial_parse": true, "log_level_file": "debug", "strict_mode": false, "profiles_dir": "/home/runner/.dbt", "cache_selected_only": false, "log_level": "info", "write_json": true, "version_check": true, "use_colors_file": true, "populate_cache": true, "exclude": [], "invocation_command": "dbt docs generate", "printer_width": 80, "log_path": "/home/runner/work/dbt_assignment_1/dbt_assignment_1/logs", "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "show_resource_report": false, "vars": {}, "print": true, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "log_format_file": "debug", "empty_catalog": false, "compile": true, "log_format": "default", "log_file_max_bytes": 10485760, "favor_state": false, "partial_parse_file_diff": true, "project_dir": "/home/runner/work/dbt_assignment_1/dbt_assignment_1", "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": false, "require_nested_cumulative_type_params": false, "introspect": true, "macro_debugging": false, "quiet": false, "skip_nodes_if_on_run_start_fails": false, "static": false, "select": [], "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "which": "generate", "require_yaml_configuration_for_mf_time_spines": false, "require_resource_names_without_spaces": false, "defer": false, "send_anonymous_usage_stats": true, "static_parser": true}}